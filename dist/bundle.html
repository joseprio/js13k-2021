<!doctype html><title>Galaxy Raid</title><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1.01"><meta name=monetization content=$ilp.uphold.com/ARgDFUGHFJ8Y><style>body,html{width:100%;height:100%;margin:0;padding:0;background:#000;overflow:hidden}#b,#g,#i,#p,#s,#t,body,html{touch-action:none;user-select:none;-webkit-user-select:none}#h,body{display:flex;align-items:center;justify-content:center}#g,#h{position:absolute;transform:scale(var(--s,.1));width:480px;height:700px;flex-direction:column}#b,#e,#i,#p,#s{position:absolute;font-size:20px}#i,#p,#s{top:0}#e{top:40px;height:15px;outline:3px solid #fff;border:2px solid transparent;transition:all .5s linear;opacity:0}#l{opacity:.6}#e,#i,#p{right:0}#b,#e,#p,#s{left:0}#b{bottom:0;transform:none}#c,#p{text-align:center}#e,button,p{color:#fff;font:400 30px Futura,"Trebuchet MS",Arial;transform:skew(6rad) scaleX(.7);margin:5px}#t{font-size:45px;text-transform:uppercase;text-shadow:0 0 5px #fff,0 0 20px #0ff}#t.b{font-size:70px}button{outline:3px solid #0ff;width:350px;height:50px;border:2px solid transparent;background:0 0;cursor:pointer;transition:all .3s ease;position:relative;margin:10px}button[d]{opacity:.5;outline-color:red}#l,button:before{position:absolute;top:0;bottom:0;left:0;width:0;transition:inherit;content:'';background:#0ff;z-index:-1}button:focus{color:#002}button:focus:before{width:100%}</style><canvas id=g></canvas><div id=h><p id=p><p id=s><div id=e><div id=l></div></div><p id=i><p id=b><p id=t><div id=c></div></div><script>function o(t,e,l){return Math.max(e,Math.min(l,t))}function a(t,e){return`rgb(${t.map(t=>t*e*100).join("%,")}%)`}function n(t,e,l){let o=(o,a=(o+6*t)%6)=>l-l*e*Math.max(Math.min(a,4-a,1),0);return[o(5),o(3),o(1)]}function r(t,e,l){return t*(l-e)+e}function h(t,e,l){return Math.floor(r(t,e,l+1))}function f(t,e,l){let o=0;for(;t()<e&&l>o;)o++;return o}function u(t,e){let l=0;for(let t=0;t<e.length;t++)l+=e[t];let o=t()*l;for(let t=0;t<e.length;t++)if(o-=e[t],0>=o)return t}function d(t){let e=new Uint32Array([Math.imul(t,2246822507),Math.imul(t,3266489909)]);return()=>{let t=e[0],l=e[1]^t;return e[0]=(t<<26|t>>8)^l^l<<9,e[1]=l<<13|l>>19,(Math.imul(t,2654435771)>>>0)/4294967295}}function M(t){return t.getContext("2d")}function m(t,e){let l=document.createElement("canvas");return l.width=t,l.height=e,[l,M(l)]}function S(t,e,l,o){t.beginPath(),t.arc(e,l,o,0,7),t.fill()}function y(t){return M(t).getImageData(0,0,t.width,t.height)}function C(t){let e=M(t),l=y(t),o=[],a=[];for(let t=0;t<l.width;t++)for(let e=0;e<l.height;e++)l.data[4*(e*l.width+t)+3]&&(o.push(t),a.push(e));let n=Math.min(...o),i=Math.min(...a),r=e.getImageData(n,i,1+Math.max(...o)-n,1+Math.max(...a)-i);return t.width=r.width,t.height=r.height,e.putImageData(r,0,0),t}function w(t,e,l,i){let s=d(l),c=d(t),M=d(e),p=[.8*r(M(),.001,1)*2**(8*M()),.9*r(M(),.001,1)*2**(8*M()),1*r(M(),.001,1)*2**(8*M()),3*M()*2**(8*M()),.5*M()*2**(8*M()),.05*M()*2**(8*M()),.5*M()*2**(8*M())],g=[],C=[],w=1+(.7>c()?1:0)+f(c,.3,3);for(let t=0;w>t;t++)g.push(n(c()**2,o(r(c(),-.2,1),0,c()**4),Math.max(r(c(),.7,1.1),1))),C.push(2**(6*c()));let x=c()/2,b=r(c(),0,.6),v=r(c(),0,.6),I=r(c(),0,.6),P=Math.floor(3*s()),R=i||r(s(),2.5,7)**3,T=r(s(),.5,1.3),G=r(s(),.7,1.7),L=r(s(),.1,1),A=r(s(),2,8),k=r(s(),.5,1.5),D=r(s(),.1,1),O=r(s(),10,50),U=r(s(),.5,1.5),B=r(s(),.03,.1),E=s()>.5?"round":"square",$=r(s(),.1,1),N=s(),H=M()>.5?1:2,W=M()/H,q=M(),z=M(),j=r(M(),-.2,1.2),J=M(),V=M(),Y=r(M(),.5,.8),F=Y-r(M(),.2,.4),Q=r(M(),0,.2),X=u(M,C),K=r(M(),.02,.1),Z=M(),_=M(),tt=M(),et=r(M(),2,6),lt=r(M(),2,7),ot=M(),at=M(),nt=M(),it=M(),rt=M(),ht=r(M(),0,.8),ft=r(M(),.5,1.5),ut=M(),st=r(M(),.2,.9),ct=r(M(),-.2,-.05),dt=r(M(),.1,3.5),Mt=p.map(M),pt=p.map(M);function mt(){let t=g[u(c,C)];return c()<x**2?[o(t[0]+b**2*o(r(c(),-1,1.2),0,1)*o((.7>c()?-1:1)+(.7>c()?-1:1),-1,1),0,1),o(t[1]+v**2*o(r(c(),-1,1.2),0,1)*o((.7>c()?-1:1)+(.7>c()?-1:1),-1,1),0,1),o(t[2]+I**2*o(r(c(),-1,1.2),0,1)*o((.7>c()?-1:1)+(.7>c()?-1:1),-1,1),0,1)]:t}let gt=Math.floor(R*T),St=Math.floor(gt/2),yt=Math.floor(gt/6),Ct=(gt-6*yt)/2,wt=Math.floor(R*G),xt=Math.floor(wt/2),bt=Math.floor(wt/6),vt=(wt-6*bt)/2,[It,Pt]=m(gt,wt),Rt=gt*wt/20;if(0==P){let t=Math.ceil(gt*L/5),e=[[[St-t,0],[St+t,wt]]],l=2+Math.floor(r(s(),.5,1)*A*R**.5);for(let t=1;l>t;t++){let t=e[h(s(),0,e.length-1)],l=[t[0][0]+s()*(t[1][0]-t[0][0]),t[0][1]+s()*(t[1][1]-t[0][1])];l[1]<(t[0][1]+t[1][1])/2&&s()<k&&(l[1]=t[1][1]-(l[1]-t[0][1]));let o=[s()*gt,s()*wt],a=Rt/Math.abs((o[0]-l[0])*(o[1]-l[1]));if(1>a&&(o[0]=l[0]+(o[0]-l[0])*a,o[1]=l[1]+(o[1]-l[1])*a),l[0]>o[0]){let t=l[0];l[0]=o[0],o[0]=t}if(l[1]>o[1]){let t=l[1];l[1]=o[1],o[1]=t}e.push([[Math.floor(l[0]),Math.floor(l[1])],[Math.ceil(o[0]),Math.ceil(o[1])]])}Pt.fillStyle="#fff",e.map(t=>{Pt.fillRect(t[0][0],t[0][1],t[1][0]-t[0][0],t[1][1]-t[0][1]),Pt.fillRect(gt-t[1][0],t[0][1],t[1][0]-t[0][0],t[1][1]-t[0][1])})}else if(1==P){let t=Math.max(2,(Rt/Math.PI)**.5),e=Math.ceil(gt*D/5),l=[],o=Math.floor(wt/(2*e));for(let t=0;o>t;t++){let o=[St,wt-e*(2*t+1)];l.push({v:o,r:e})}let a=o+Math.floor(r(s(),.5,1)*O*R**.5);for(let e=o;a>e;e++){let e=l[Math.max(h(s(),0,l.length-1),h(s(),0,l.length-1))],o=r(s(),1,t),a=r(s(),Math.max(0,e.r-o),e.r),n=r(s(),0,2*Math.PI);n>Math.PI&&s()<U&&(n=r(s(),0,Math.PI));let i=[e.v[0]+Math.cos(n)*a,e.v[1]+Math.sin(n)*a];o=Math.min(o,i[0],gt-i[0],i[1],wt-i[1]),l.push({v:i,r:o})}Pt.fillStyle="#fff",l.map(t=>{S(Pt,t.v[0],t.v[1],t.r),S(Pt,gt-t.v[0],t.v[1],t.r)})}else{let t=[[St,r(s(),0,.05)*wt],[St,r(s(),.95,1)*wt]],e=6/R+B,l=Math.max(3,Math.ceil(r(s(),.05,.1)/e*R**.5));Pt.lineCap=E,Pt.strokeStyle="#fff";for(let o=1;l>o;o++){let l=t[o];l||(l=[s()*gt,s()**$*wt],t.push(l));let a=1+f(s,N,3);for(let o=0;a>o;o++){let o=t[h(s(),0,t.length-2)];Pt.lineWidth=r(s(),.7,1)*e*R,Pt.beginPath(),Pt.moveTo(o[0],o[1]),Pt.lineTo(l[0],l[1]),Pt.stroke(),Pt.beginPath(),Pt.moveTo(gt-o[0],o[1]),Pt.lineTo(gt-l[0],l[1]),Pt.stroke()}}}let Tt=y(It);function Gt(t,e){return Tt.data[4*(e*gt+t)+3]}let Lt=[];for(let t=0;yt>t;t++){Lt[t]=[];for(let e=0;bt>e;e++)Lt[t][e]=[t,e,Math.floor(Ct+6*(t+.5)),Math.floor(vt+6*(e+.5))]}let At=[Lt[Math.floor(yt/2)][Math.floor(bt/2)]];for(let t=0;t<At.length;t++){let e=At[t];if(e[0]>0){let t=Lt[e[0]-1][e[1]];t[4]||(Gt(t[2],t[3])?(t[4]=1,At.push(t)):t[4]=2)}if(e[0]<yt-1){let t=Lt[e[0]+1][e[1]];t[4]||(Gt(t[2],t[3])?(t[4]=1,At.push(t)):t[4]=2)}if(e[1]>0){let t=Lt[e[0]][e[1]-1];t[4]||(Gt(t[2],t[3])?(t[4]=1,At.push(t)):t[4]=2)}if(e[1]<bt-1){let t=Lt[e[0]][e[1]+1];t[4]||(Gt(t[2],t[3])?(t[4]=1,At.push(t)):t[4]=2)}}for(let t=0;t<At.length;t++){let e=At[t],l=Lt[yt-1-e[0]][e[1]];1!=l[4]&&(l[4]=1,At.push(l))}let kt=Math.max(1,Math.floor(At.length*W)),Dt=H*At.length+kt;function Ot(t,e){let l=Math.floor((t-Ct)/6),o=Math.floor((e-vt)/6);if(l>=0&&yt>l&&o>=0&&bt>o)return 1==Lt[l][o][4]}function Ut(t){return 1-t[1]/wt}function Bt(t,e){let l=Math.min(1,1-Math.abs(t[0]-St)/St);return e&&(l=Math.min(l,1-Math.abs(t[1]-xt)/xt)),l}function Et(t,e,l,o,a,n,i){let h=(Bt(e,1)*(1-1/((gt+wt)/1e3+1))*q**.5*(1-zt/Dt))**l,f=8;if(M()<r(Mt[t],o,a)*h){let l=r(pt[t],n,i);for(;M()<l*h&&f/2<Math.min(e[0]-f,gt-e[0]-f,e[1]-f,wt-e[1]-f);)f*=1.5}return f}function $t(t,e,l){let o=Pt.createLinearGradient(e[0],e[1],2*t[0]-e[0],2*t[1]-e[1]),a=`rgba(0,0,0,${l})`;return o.addColorStop(0,a),o.addColorStop(.5,"rgba(0,0,0,0)"),o.addColorStop(1,a),o}It.width|=0;let Nt=[t=>{let e=Et(0,t,.3,0,.9,0,.5),l=2*e,n=Math.ceil(r(M(),1,Math.max(2,e/2))),i=Math.ceil(r(M(),1,Math.max(2,e/2))),h=Math.min(n,i)*r(M(),.1,1.2),f=n+2*h,u=i+2*h,s=Math.ceil(l/f),c=Math.ceil(l/u),d=Math.round(s*f/2),p=Math.round(c*u/2),m=mt();Pt.fillStyle=`rgba(0,0,0,${r(M(),0,.25)})`,Pt.fillRect(t[0]-d-1,t[1]-p-1,f*s+2,u*c+2),Pt.fillStyle=a(m,r(M(),.4,1)),Pt.fillRect(t[0]-d,t[1]-p,f*s,u*c),Pt.fillStyle=a(m,r(M(),.4,1));for(let e=0;s>e;e++){let l=t[0]+h+e*f-d;for(let e=0;c>e;e++){let o=t[1]+h+e*u-p;Pt.fillRect(l,o,n,i)}}M()<o(e/8*(.6*zt/Dt+.3),0,.98)&&(Pt.fillStyle=$t(t,[t[0]+d,t[1]],r(M(),0,.9)),Pt.fillRect(t[0]-d,t[1]-p,f*s,u*c))},t=>{let e=Et(1,t,.2,.3,1,0,.6),l=Math.ceil(r(M(),.8,2)*e),n=Math.ceil(r(M(),.8,2)*e),i=h(M(),3,Math.max(4,l)),f=Math.max(1,Math.round(l/i)),u=f*i,s=a(mt(),r(M(),.5,1)),c=r(M(),.3,.9);if(M()<o(j,0,1)){let e=[t[0]-Math.floor(u/2),t[1]-Math.floor(n/2)];Pt.fillStyle=`rgba(0,0,0,${r(M(),0,.25)})`,Pt.fillRect(e[0]-1,e[1]-1,u+2,n+2),Pt.fillStyle=s,Pt.fillRect(e[0],e[1],u,n);for(let l=0;f>l;l++)Pt.fillStyle=$t([e[0]+(l+.5)*i,t[1]],[e[0]+l*i,t[1]],c),Pt.fillRect(e[0]+l*i,e[1],i,n)}else{let e=[t[0]-Math.floor(n/2),t[1]-Math.floor(u/2)];Pt.fillStyle=`rgba(0,0,0,${r(M(),0,.25)})`,Pt.fillRect(e[0]-1,e[1]-1,n+2,u+2),Pt.fillStyle=s,Pt.fillRect(e[0],e[1],n,u);for(let l=0;f>l;l++)Pt.fillStyle=$t([t[0],e[1]+(l+.5)*i],[t[0],e[1]+l*i],c),Pt.fillRect(e[0],e[1]+l*i,u,i)}},t=>{let e=Et(2,t,.05,0,1,0,.9),l=Math.ceil(r(M(),.6,1.4)*e),n=Math.ceil(r(M(),1,2)*e),i=Math.ceil(Math.max(l*r(M(),.7,1)/2,1)),h=Math.ceil(Math.max(l*r(M(),.8,1)/2,1)),f=Math.floor(o(l*r(M(),.05,.25),1,n)),u=Math.floor(o(l*r(M(),.1,.3),1,n)),s=f+u,c=M()<J**.5,d=Math.max(Math.floor(n/s),1),p=d*s+(c?f:0),m=mt(),g=r(M(),.6,1),S=r(M(),.6,1),y=a(m,g),C=a(m,S),w=1-r(M(),.5,.95),x=a(m,w*g),b=a(m,w*S);if(M()<V**.1){let e=Pt.createLinearGradient(t[0]-i,t[1],t[0]+i,t[1]),l=Pt.createLinearGradient(t[0]-h,t[1],t[0]+h,t[1]),o=Math.floor(t[1]-p/2);e.addColorStop(0,x),e.addColorStop(.5,y),e.addColorStop(1,x),l.addColorStop(0,b),l.addColorStop(.5,C),l.addColorStop(1,b);for(let a=0;d>a;a++)Pt.fillStyle=e,Pt.fillRect(t[0]-i,o+a*s,2*i,f),Pt.fillStyle=l,Pt.fillRect(t[0]-h,o+a*s+f,2*h,u);c&&(Pt.fillStyle=e,Pt.fillRect(t[0]-i,o+d*s,2*i,f))}else{let e=Pt.createLinearGradient(t[0],t[1]-i,t[0],t[1]+i),l=Pt.createLinearGradient(t[0],t[1]-h,t[0],t[1]+h),o=Math.floor(t[0]-p/2);e.addColorStop(0,x),e.addColorStop(.5,y),e.addColorStop(1,x),l.addColorStop(0,b),l.addColorStop(.5,C),l.addColorStop(1,b);for(let a=0;d>a;a++)Pt.fillStyle=e,Pt.fillRect(o+a*s,t[1]-i,f,2*i),Pt.fillStyle=l,Pt.fillRect(o+a*s+f,t[1]-h,u,2*h);c&&(Pt.fillStyle=e,Pt.fillRect(o+d*s,t[1]-i,f,2*i))}},t=>{if(M()<Ut(t)-.3||Ot(t[0],t[1]+6*1.2)||Ot(t[0],t[1]+10.8))for(;;){let e=u(M,p);if(3!=e)return void Nt[e](t)}let e=Et(3,t,.1,.6,1,.3,.8),l=r(M(),1,2)*e,o=Math.ceil(r(M(),.3,1)*e),n=l*r(M(),.25,.6),i=(l+n)/4,h=Math.max(1,Math.ceil(o*r(M(),.08,.25))),f=h+Math.max(1,Math.ceil(o*r(M(),.03,.15))),s=Math.ceil(o/f),c=s*f+h,d=g[X],m=Pt.createLinearGradient(t[0]-i,t[1],t[0]+i,t[1]),S=Pt.createLinearGradient(t[0]-i,t[1],t[0]+i,t[1]),y=Math.ceil(t[1]-c/2),C=y+h,w=y+f;m.addColorStop(0,a(d,F)),m.addColorStop(.5,a(d,Y)),m.addColorStop(1,a(d,F)),S.addColorStop(0,a(d,Q)),S.addColorStop(.5,a(d,1)),S.addColorStop(1,a(d,Q)),Pt.fillStyle=m,Pt.beginPath(),Pt.moveTo(t[0]-n/2,y),Pt.lineTo(t[0]+n/2,y),Pt.lineTo(t[0]+l/2,y+c),Pt.lineTo(t[0]-l/2,y+c),Pt.fill(),Pt.fillStyle=S;for(let e=0;s>e;e++){let o=[C+e*f,w+e*f],a=[(n+(e*f+h)/c*(l-n))/2,(n+(e+1)*f/c*(l-n))/2];Pt.beginPath(),Pt.moveTo(t[0]-a[0],o[0]),Pt.lineTo(t[0]+a[0],o[0]),Pt.lineTo(t[0]+a[1],o[1]),Pt.lineTo(t[0]-a[1],o[1]),Pt.fill()}},t=>{let e,l=Bt(t,0),o=r(M(),.7,1),n=r(M(),0,.2),i=mt(),f=a(i,o),s=a(i,n),c=Math.max(3,Math.ceil(R*r(M(),.4,1)**2*K)),d=Math.floor(c/2),p=c%2,m=u(M,[Z**4*(2-l),.1*_**4,.2*tt**4*(1+l)]);if(m)if(2>m){let l=wt-t[1],o=Math.min(Math.max(8,l-h(M(),0,16)),Math.floor(.6*R*M()**lt)),a=t[0]-d,n=t[1],i=t[0]+d+p,r=Pt.createLinearGradient(a,n,i,n);r.addColorStop(0,s),r.addColorStop(.5,f),r.addColorStop(1,s),Pt.fillStyle=r,Pt.fillRect(a,n,c,o),e=[t[0],t[1]+o]}else{let l=Pt.createLinearGradient(t[0],t[1]-d,t[0],t[1]+d+p);l.addColorStop(0,s),l.addColorStop(.5,f),l.addColorStop(1,s),Pt.fillStyle=l,Pt.fillRect(t[0],t[1]-d,Math.ceil(St-t[0])+1,c),e=[St,t[1]]}else{let l=t[1],o=Math.min(Math.max(8,l-h(M(),0,16)),Math.floor(.7*R*M()**et)),a=t[0]-d,n=t[1]-o,i=t[0]+d+p,r=Pt.createLinearGradient(a,n,i,n);r.addColorStop(0,s),r.addColorStop(.5,f),r.addColorStop(1,s),Pt.fillStyle=r,Pt.fillRect(a,n,c,o),e=[t[0],t[1]-o]}let g=[.6*ot**2,.2*at**2,nt**2];if(Nt[u(M,g)](t),Ot(e[0],e[1])){let t=[e[0]+Math.round(6*r(M(),-1,1)),e[1]+Math.round(6*r(M(),1,1))];Nt[u(M,g)](Ot(t[0],t[1])?t:e)}},t=>{let e=Et(5,t,.1,0,.9,0,.8),l=r(M(),.75,1),o=r(M(),0,.25),n=mt(),i=a(n,l),h=a(n,o),u=1+f(M,it,Math.floor(1.2*(e/8)**.6)),s=1+f(M,rt,Math.floor(1.2*(e/8)**.6)),c=r(M(),.5,1)*e/Math.max(u,s),d=c+.5,p=[t[0]-c*u,t[1]-c*s];Pt.fillStyle=`rgba(0,0,0,${r(M(),0,.2)})`;for(let t=0;u>t;t++){let e=p[0]+(2*t+1)*c;for(let t=0;s>t;t++)S(Pt,e,p[1]+(2*t+1)*c,c+1)}for(let t=0;u>t;t++){let e=p[0]+(2*t+1)*c;for(let t=0;s>t;t++){let l=p[1]+(2*t+1)*c,o=Pt.createRadialGradient(e,l,c/5,e,l,d);o.addColorStop(0,i),o.addColorStop(1,h),Pt.fillStyle=o,S(Pt,e,l,d)}}},t=>{if(0>=Wt||M()<Ut(t))return void Nt[u(M,p.slice(0,6))](t);let e=Et(6,t,.05,0,.9,0,.8),l=Math.ceil(2*e*r(M(),.6,1)),o=Math.floor(l/2),n=l%2,i=l*r(M(),ht**.5,.9)**ft,h=Math.floor(i/2),f=Math.max((i-l)/2,l*(r(M(),0,.45)+r(M(),0,.45))*(.8>ut?st:ct)),s=Math.ceil(e*r(M(),.7,1)*dt**.5),c=Math.floor(s/2),d=s%2,m=[[t[0]-c,t[1]+f-h],[t[0]+c+d,t[1]-o],[t[0]+c+d,t[1]+o+n],[t[0]-c,t[1]+f+h+l%2]],g=mt();Pt.fillStyle=`rgba(0,0,0,${r(M(),0,.2)})`,Pt.beginPath(),Pt.moveTo(m[0][0]-1,m[0][1]),Pt.lineTo(m[1][0]-1,m[1][1]),Pt.lineTo(m[2][0]-1,m[2][1]),Pt.lineTo(m[3][0]-1,m[3][1]),Pt.fill(),Pt.fillStyle=a(g,r(M(),.7,1)),Pt.beginPath(),Pt.moveTo(m[0][0],m[0][1]),Pt.lineTo(m[1][0],m[1][1]),Pt.lineTo(m[2][0],m[2][1]),Pt.lineTo(m[3][0],m[3][1]),Pt.fill()}],Ht=0,Wt=0,qt=0,zt=0;for(;;){let t;if(H>Wt)qt<At.length?(t=At[qt],qt++):(Wt++,t=At[0],qt=1);else{if(Ht>=kt)break;t=At[h(M(),0,At.length-1)],Ht++}let e=[t[2],t[3]];for(let l=0;10>l;l++){let l=[t[2]+h(M(),-6,6),t[3]+h(M(),-6,6)];if(!(0>l[0]||l[0]>gt||0>l[1]||l[1]>wt)&&Gt(l[0],l[1])){e=l;break}}6>Math.abs(e[0]-St)&&M()<z&&(e[0]=St),Nt[u(M,p)](e),zt++}return Pt.clearRect(gt-St,0,St,wt),Pt.scale(-1,1),Pt.drawImage(It,-gt,0),It}function x(t){let e=t.width,l=t.height,o=Math.max(12,Math.floor(Math.min(e,l)/12)),a=y(t),n=Math.floor(e/o),i=Math.floor(l/o),r=[],h=Math.floor(l/i/2);for(let t=0;i>t;t++){let o=Math.floor(e/((2-t%2)*n));for(let a=0;n-t%2>a;a++)r.push([1e9,1e9,0,0,o+(a+(Math.random()-.5))*e/n,h+(t+(Math.random()-.5))*l/i,[]])}for(let t=0;l>t;t++)for(let l=0;e>l;l++){let o=4*(t*e+l);if(a.data[o+3]){let e,n=1e9;r.map(o=>{let a=Math.hypot(o[4]-l,o[5]-t);n>a&&(n=a,e=o)}),e[0]=Math.min(l,e[0]),e[2]=Math.max(l,e[2]),e[1]=Math.min(t,e[1]),e[3]=Math.max(t,e[3]),e[6].push([l,t,a.data.slice(o,o+4)])}}let f=[];return r.sort((t,e)=>e[6].length-t[6].length).map(t=>{if(1e9>t[0]){let e=t[2]-t[0]+1,l=t[3]-t[1]+1,[o,a]=m(e,l),n=y(o);t[6].map(l=>n.data.set(l[2],4*((l[1]-t[1])*e+(l[0]-t[0])))),a.putImageData(n,0,0),f.push([t[4],t[5],t[0]-t[4],t[1]-t[5],o])}}),f}function v(t,e,l){let o=t[0]-e/2,a=t[1]-l/2,n=Math.hypot(o,a),i=n**2,r=n*(.5+1.5*Math.random());return[...t,r*(1-a**2/i)**.5*(o>0?1:-1),r*(1-o**2/i)**.5*(a>0?1:-1),3*(Math.random()-.5)]}let I=new(window.AudioContext||webkitAudioContext),P=([t,e,l,o=.06,a=4,n=0,i=0,r=0,h=0,f=0,u=.1,s=.04,c=0,d=0,M=0,p=.04,m=0,g=0,S=0])=>{let y,C,w,x,b=2*Math.PI,v=n*=500*b/44100/44100,P=t*=(1+0*Math.random()-0)*b/44100,R=[],T=0,G=0,L=0,A=1,k=0,D=0,O=0;for(f*=500*b/44100**3,d*=b/44100,S*=b/44100,g*=44100,m=44100*m|0,C=(r=44100*r+9)+(p*=44100)+(o*=44100)+(e*=44100)+(h*=44100)|0;C>L;R[L++]=O)++D%(100*c|0)||(O=a?a>1?a>2?a>3?Math.sin((T%b)**3):Math.max(Math.min(Math.tan(T),1),-1):1-(2*T/b%2+2)%2:1-4*Math.abs(Math.round(T/b)-T/b):Math.sin(T),O=(m?1-i+i*Math.sin(b*L/m):1)*(O>0?1:-1)*Math.abs(O)**u*s*.3*(r>L?L/r:r+p>L?1-(L-r)/p*(1-l):r+p+o>L?l:C-h>L?(C-L-h)/e*l:0),O=h?O/2+(h>L?0:(C-h>L?1:(C-L)/h)*R[L-h|0]/2):O),y=(t+=n+=f)*Math.cos(d*G++),T+=y-y*M*(1-1e9*(Math.sin(L)+1)%2),A&&++A>g&&(t+=S,P+=S,A=0),!m||++k%m||(t=P,n=v,A||=1);return w=I.createBuffer(1,C,44100),w.getChannelData(0).set(R),x=I.createBufferSource(),x.buffer=w,x.connect(I.destination),x.start(),x};function R(){P([467,.14,.58,,,,.02,,,,,.1,.4,303,.5,.02])}function T(t){P([274,.67,.63,.03,,,,,.25,,1.11,t,.5,,.8,.02,.04])}function G(){P([279,.09,.89,.09,3,-4.9,.02,.02,.05,-.6,1.2,.15])}function L(t,e,l){z.drawImage(t,Math.round(e),Math.round(l))}function A(t){z.save(),t(),z.restore()}function k(t){let[e,l]=m(t.width,t.height),o=y(t),a=o.data;for(let t=0;t<a.length;t+=4){let[e,l,o]=a.slice(t,t+4);a.set([255-(.393*e+.769*l+.189*o),255-(.349*e+.686*l+.168*o),255-(.272*e+.534*l+.131*o)],t)}return l.putImageData(o,0,0),e}function D(t,e){return O(t,e,6,"#0ff","#00f")}function O(t,e,l,o,a){let[n,i]=m(20*t,20*t);return i.translate(9*t,9*t),i.rotate(e),i.fillStyle="#ff0",i.beginPath(),i.moveTo(t,t*l),i.lineTo(0,t),i.arc(t,t,t,Math.PI,0),i.lineTo(t,t*l),i.fill(),i.strokeStyle=o,i.shadowColor=a,i.globalCompositeOperation="source-atop",i.shadowBlur=Math.round(t/2),i.lineWidth=t/2,i.beginPath(),i.moveTo(t,t*l),i.lineTo(0,t),i.arc(t,t,t,Math.PI,0),i.lineTo(t,t*l),i.stroke(),n=C(n),[n,y(n).data]}function U(t,e){let[l,o]=m(t,t),a=o.createRadialGradient(t/2,t/2,0,t/2,t/2,t/2);return a.addColorStop(e,"#ff0"),a.addColorStop(1,"#f00"),o.fillStyle=a,S(o,t/2,t/2,t/2),l}function B(t){let e=[];for(let l=9;l--;)e.unshift(U(t,l/10)),e.push(U(t,l/10));return[e,y(e[0]).data]}function E(t){let[e,l]=m(t.width,t.height);return l.scale(1,-1),l.drawImage(t,0,0,t.width,-t.height),e}let $,N,H,W=["#9af","#abf","#ccf","#fef","#fee","#fc9","#fc6"],q=g,z=M(q),j=[],J=["Main Gun","Side Cannon","Shield","Bombs","Magnet"],V=["Andromeda","Borealis","Cygnus","Draco","Endgame","Survival"],Y=[O(5,0,4,"#f80","#f00"),O(4,0,4,"#f80","#f00")],F=[D(6,-.245),D(6,0),D(6,.245)],Q=[D(10,-.245),D(10,0),D(10,.245)],X=[B(8),B(14),B(20),B(28)],K=JSON.parse(localStorage["Galaxy Raid"]||0)||{l:0,s:0,u:J.map(()=>0),c:0,f:0};function Z(){N=C(w(K.c||1301,5,114,40)),H=x(N)}Z();let _,tt,et,lt,ot,at,nt,it,rt,ht,ft,ut,st,ct,dt,Mt,pt,mt,gt,St,yt,Ct,wt,xt,bt,vt,It,Pt,Rt=N.width,Tt=N.height,Gt=Math.floor(Rt/2),Lt=Math.floor(Tt/2),At=y(N).data,kt=[],Dt=performance.now(),Ot=["\u21e6 Main Menu",Et];function Ut(t,e){let l=10**(K.u[e]+1),o=[];!e||K.u[e]?o.push("Quality: "+(K.u[e]?"\u2b50".repeat(K.u[e]):"Standard")):o.push("Not Acquired"),3>K.u[e]&&o.push([(!e||K.u[e]?"Upgrade":"Buy")+": "+l.toLocaleString()+" \u267a",l<=K.s&&(()=>{K.u[e]++,qt(-l),Ut(t,e)})]),o.push(["\u21e6 Back",()=>Wt("Upgrades",Bt(),e)]),Wt(t,o)}function Bt(){return[...J.map((t,e)=>["\u2b50".repeat(K.u[e])+" "+t,()=>Ut(t,e)]),["Refund All Upgrades",K.u.some(t=>!!t)?()=>{let t=0;K.u=K.u.map(e=>{for(let l=1;e>=l;l++)t+=10**l;return 0}),qt(t),Wt("Upgrades",Bt(),0)}:0],Ot]}function Et(){let t=[["Play",$t],["Upgrades",()=>Wt("Upgrades",Bt())],["Top Scores",K[0]?()=>Wt("Top Scores",(()=>{let t=[];for(let e=0;K[e];e++)t.push("\u{1f3c6} "+V[e]+": "+K[e].toLocaleString()+" points");return t.push(Ot),t})()):0],["Supporter Options",()=>Wt("Supporter Options",Nt())]];Wt("Galaxy Raid",t,0,1)}function $t(){let t=[];for(let e=0;6>e;e++){let l=e;t.push(e>K.l?["\u{1f512} "+V[l]]:[V[l],()=>Xt(l)])}t.push(Ot),Wt("Select Mission",t,K.l)}function Nt(){let t=[],e="started"==document.monetization?.state;return e||t.push("Coil not detected"),t.push(["Ship Color",e&&(()=>Wt("Ship Color",Ht()))]),t.push(["Claim "+1e3.toLocaleString()+" \u267a",e&&!K.f&&(()=>{qt(1e3),K.f=1,Jt(),Wt("Supporter Options",Nt())})]),t.push(["Unlock All Missions",e&&K.l-5&&(()=>{K.l=5,Jt(),Wt("Supporter Options",Nt())})]),t.push(Ot),t}function Ht(){return[N,["Randomize",()=>{K.c=h(Math.random(),0,1e9),Jt(),Z(),Wt("Ship Color",Ht())}],["\u21e6 Back",()=>Wt("Supporter Options",Nt())]]}function Wt(e,l,o=0,a){let n;t.style.transition="",t.className=a?"b":"",t.textContent=e,c.textContent="",l&&l.map((t,e)=>{if(t.map){let l=document.createElement("button");l.textContent=t[0],t[1]?l.onpointerdown=e=>{e?.preventDefault(),t[1]()}:l.setAttribute("d",""),c.appendChild(l),n||o>e||l.hasAttribute("d")||(n=l.style.transition="none",l.focus(),l.offsetHeight,l.style.transition="")}else if(t.width){let e=document.createElement("div");e.appendChild(t),c.appendChild(e)}else{let e=document.createElement("p");e.textContent=t,c.appendChild(e)}})}function qt(t){K.s+=t,Jt(),s.textContent="\u267a: "+K.s.toLocaleString()}Et(),qt(0),(self.onorientationchange=self.onresize=()=>{document.documentElement.style.setProperty("--s",Math.min(innerWidth/480,innerHeight/700))})();for(let t=0;10>t;t++){let[e,l]=m(Rt+20,Tt+20),o=t?0:10;for(let t=-1;2>t;t++)for(let e=-1;2>e;e++)l.drawImage(j[0]||N,e+o,o+t);l.globalCompositeOperation="source-in",l.fillStyle=t>5?"#0ff":"#00f",l.fillRect(0,0,1e9,1e9),l.globalCompositeOperation="source-over",t&&l.drawImage(j[0],0,0),j.unshift(e)}function zt(t){wt+=t,p.textContent=wt.toLocaleString(),K[ht]&&wt<=K[ht]||(K[ht]=wt,Jt(),Mt=1),i.textContent="TOP: "+K[ht].toLocaleString()}function jt(){b.textContent="\u{1f4a5} ".repeat(gt)}function Jt(){localStorage["Galaxy Raid"]=JSON.stringify(K)}j.map(t=>{let e=M(t);e.globalCompositeOperation="destination-out",e.globalAlpha=.2;for(let t=5;9>t;t++)e.drawImage(j[t],0,0)}),j.length=5;let Vt=[[34,145,300],[141,50,200],[1905,111,220],[2514,491,220],[2066,334,300],[269,101,250]],Yt=[12,255,552,589,308,8],Ft=[1,2e3,3e3,4e3,0,6e3],Qt=[[[34,213,0,15,.35],[34,9,80,30,.35,1e3,t=>t(0,.3)],[34,18,100,50,.25,1e3,(t,e,l)=>(t(0,.3),l%3?250:1e3),150],[34,73,310,100,.15,0,0,0,[1,8,.45]]],[[20,18,40,30,.35,700,t=>t(0,.3)],[20,91,80,60,.3,550,(t,e,l)=>{if(e(0,8,Math.PI/8,.3),3>l)return 200}],[20,9,120,140,.15,800,(t,e,l)=>{let o=l%3;return t(1,.3),o?250:1e3}],[109,203,40,80,.55,0,0,0,0,.002]],[[51,91,120,120,.15,0,0,0,[1,11,.45]],[51,9,60,30,.4,800,t=>t(0,.3),0,0,0,1],[51,156,100,120,.35,800,(t,e,l)=>{let o=l%4;return t(1,.3+(l-1)%4*.05),o?50:800}],[51,11,100,80,.35,800,(t,e,l)=>{let o=l%4;return o?t(0,.3):e(0,8,0,.3),o?250:1e3},150]],[[89,218,60,40,.4,600,(t,e,l)=>{if(t(0,.3,1,Math.PI/24),3>l)return 200}],[89,50,100,120,.4,800,(t,e,l)=>{let o=l%10;return 4>o?t(2,.4):e(0,5,o*Math.PI/12,.3),3>o?200:3==o?500:9>o?100:800},150],[1492,43,40,40,.55,0,0,0,0,.002,1],[320,397,120,200,.15,1400,(t,e,l)=>{if(e(0,12,l%2?0:Math.PI/12,.3+.1*l),4>l)return 100}]],[],[]];function Xt(t){Wt("Please wait\u2026"),xt=1,$=[],bt=[],vt=[],It=[],Pt=[],ht=t,ft=ht-5?t:0}let Kt=0,Zt=0,_t=0;function te(t){let e=[...c.children],l=e.indexOf(document.activeElement);do{l+=t,e[l]||(l=t>0?0:e.length-1)}while(e[l].hasAttribute("d"));e[l].focus()}function ee(t,e){let l=Math.round(t[0]-t[2]/2),o=Math.round(t[1]-t[3]/2),a=Math.round(e[0]-e[2]/2),n=Math.round(e[1]-e[3]/2);if(l<a+e[2]&&l+t[2]>a&&o<n+e[3]&&o+t[3]>n){let i=Math.min(l+t[2],a+e[2]),r=Math.min(o+t[3],n+e[3]),[h,f,u]=l>a?[0,l-a,i-l]:[a-l,0,i-a],[s,c,d]=o>n?[0,o-n,r-o]:[n-o,0,r-n];for(let l=0;d>l;l++)for(let o=0;u>o;o++)if(t[4][4*((s+l)*t[2]+h+o)+3]>0&&e[4][4*((c+l)*e[2]+f+o)+3]>0)return 1}}function le(t,e){mt?(mt--,P([119,.44,.85,0,0,5.3,,,.01,-4.2,.09,.9,.1,-340,.7,.08])):Ie(t,e)}function oe(t,e){return(l,o)=>{if(t>l)return 1;e(l,o)}}function ae(t,e,l,o,a,n){return i=>{let r=[t+=.625*(o-1)*(i-n)/4,e-=.625*(i-n),l[0].width,l[0].height,l[1]];for(let t=0;t<ce.length;t++)if(ce[t](r,a,i))return;if(e+l[0].height/2>0)return n=i,L(l[0],t-l[0].width/2,e-l[0].height/2),1}}function ne([t,e,l,o,a,n,i,r],h,f,u,s){return c=>{let d=(c-s)/u;if(1>d)return A(()=>{z.globalAlpha=1-d**2,z.translate(h+t+n*d,f+e+i*d),z.rotate(r*d),L(a,l,o)}),1}}let ie=["#710","#a21","#d42","#e93","#fa5"];function re(t,e,l,o,a){let n=r(Math.random(),10,50),i=ie[h(Math.random(),0,ie.length-1)],f=t+h(Math.random(),-l/2,l/2),u=e+h(Math.random(),-o/2,o/2);return t=>{let e=(t-a)/500;if(1>e)return A(()=>{z.globalCompositeOperation="lighter",z.fillStyle=i,z.beginPath(),z.arc(f,u,n*(1-e),0,7),z.fill()}),1}}function he(t,e){return Math.atan2(nt-t,it-e)}function fe(t,e,l,o,a,n){let[i,r]=X[t],h=i[0].width,f=i[0].height,u=a*Math.cos(o),s=a*Math.sin(o);return(t,o,a)=>{if(pt>t)return;let c=t-n;return ee(ut,[e+=c*s,l+=c*u,h,f,r])&&(le(t,a),!st)||l-f/2>700||0>l+f/2||e-h/2>480||0>e+h/2?void 0:(n=t,L(i[t%i.length|0],e-h/2,l-f/2),2)}}function ue(t,e,l,o,a,n,i,r){for(let h=0;l>h;h++)t.push(fe(e,o,a,n+2*h*Math.PI/l,i,r))}let se,ce,de,Me,pe,me,ge,Se,ye=[800,2e3,2e3,3e3,4e3];function Ce(t){let o,a,n=4==ht?Ct:ht,i=4==ht?n:0,r=bt[i],h=vt[i],f=It[i],u=Pt[i],s=r.width,c=r.height,d=0,M=1e9,p=1e9,m=t,g=240,S=-800,y=1,C=n-3?0:2,w=0,x=0,b=0;function I(t,e,a){if(ee(t,o))return 4==n&&M>=p/2&&p/2>M-e&&(b=1),w=a,M-=e,l.style.width=100*M/p+"%",M>0&&R(),1}return e.style.opacity=1,l.style.width="100%",(t,i,R)=>{let T=0;if(M>0)if(b)b=0,u.map(e=>R.push(ne(v(e,s,c),g-s/2,S-c/2,500,t))),n++,r=bt[n],h=vt[n],f=It[n],u=Pt[n],s=r.width,c=r.height,a=t+1e3,x=0;else{let e=t-m;if(d)if(n>4){if(!st){let t=he(g,S);g+=.1*Math.sin(t)*e,S+=.1*Math.cos(t)*e}}else n&&(1==y?(g+=.1*e,g+s/2>480&&(g=480-s/2,1==n||3==n||4==n?y=2:2==n&&(y=0,C=2))):2==y&&(g-=.1*e,0>g-s/2&&(g=s/2,1==n||3==n||4==n?y=1:(y=0,C=1))),2==C?(S+=.1*e,S+c/2>700&&(S=700-c/2,2==n?(C=0,y=2):C=1)):1==C&&(S-=.1*e,0>S-c/2&&(S=c/2,2==n?(C=0,y=1):C=2)));else S+=.2*e,S>150&&(S=150,p=M=ye[n],d=1,a=t)}else T=1;if(T){e.style.opacity="",l.style.width="",P([369,1,.77,.1,2,.4,,,.37,,.05,1.1,.8,-1.3,.7]),zt(1e3*(n+1)),u.map(e=>i.push(ne(v(e,s,c),g-s/2,S-c/2,500,t)));for(let e=0;Math.ceil(s*c/500)>e;e++)i.push(re(g,S,s,c,t));return void(ht-4||4==Ct?(k=t,st||(ct=1,K.l=Math.max(ht+1,K.l),Jt(),dt=k+3500,pt=k+1e3,ve("Well Done"))):(Ct++,i.push(oe(t+3e3,(t,e)=>e.push(Ce(t))))))}var k;o=[g,S,s,c,h],ee(ut,o)&&Ie(t,R),m=t,L(r,g-s/2,S-c/2);let D=400-t+w;if(D>0&&A(()=>{z.globalAlpha=D/400,L(f,g-s/2,S-c/2)}),!st&&1==d&&t>a)if(G(),0==n){if(5>x){let e=S+125;i.push(fe(0,g,e,he(g,e),.3,t))}else ue(i,1,16,g,S,x-5?0:Math.PI/16,.5,t);x++,x>6?(x=0,a=t+800):a=x>4?t+100:t+200}else if(1==n){if(8>x){let[e,l]=[[61,75],[78,66],[99,76],[115,65]][Math.floor(x/2)];i.push(fe(1,g-e,S+l,0,.6,t),fe(1,g+e,S+l,0,.6,t))}else{let e=S+77;i.push(fe(3,g,e,he(g,e),.35+.1*(x-8),t))}x++,x>16?(x=0,a=t+800):a=x>8?t+100:8==x?t+500:x%2?t+100:t+200}else if(2==n){if(8>x){let e=he(g,S),l=g+70*Math.sin(e),o=S+70*Math.cos(e);i.push(fe(2,l,o,e,.4,t))}else ue(i,1,3,g,S,x*Math.PI/10,.35,t);x++,x>30?(x=0,a=t+800):a=9>x?t+300:t+50}else if(3==n){if(20>x)ue(i,2,2,g,S,Math.PI/20+x*Math.PI/10,.4,t),ue(i,2,2,g,S,-Math.PI/20-x*Math.PI/10,.4,t);else{let e=he(g,S),l=g+70*Math.sin(e),o=S+70*Math.cos(e);i.push(fe(1,l,o,e-Math.PI/8,.5,t)),i.push(fe(1,l,o,e+Math.PI/8,.5,t)),i.push(fe(3,l,o,e,.5,t))}x++,20==x?a=t+1500:x>25?(x=0,a=t+1500):a=x>20?t+150:t+50}else if(4==n){if(12>x){let[e,l]=[[48,113],[79,107],[99,108],[123,102],[156,86],[166,59]][x>5?11-x:x];i.push(fe(2,g-e,S+l,0,.6,t),fe(2,g+e,S+l,0,.6,t))}else{let e=g+(x%2?21:-21),l=S+112,o=he(e,l);i.push(fe(3,e,l,o,.4,t)),i.push(fe(2,e,l,o-Math.PI/8,.4,t)),i.push(fe(2,e,l,o+Math.PI/8,.4,t)),i.push(fe(1,e,l,o-Math.PI/4,.4,t)),i.push(fe(1,e,l,o+Math.PI/4,.4,t))}x++,x>16?(x=0,a=t+800):a=x>12?t+150:t+100}else ue(i,3,8,g,S,x%2?0:Math.PI/8,.4,t),x++,x>1?(x=0,a=t+800):a=t+200;return I}}function we(){return(navigator.getGamepads?[...navigator.getGamepads()]:[]).filter(t=>!!t)}function xe(t){let e=we();for(let l=0;l<e.length;l++)try{if(e[l].buttons[t].pressed)return 1}catch(t){}}function be(t){let e=we(),l=0;for(let o=0;o<e.length;o++)try{l+=e[o].axes[t]}catch(t){}return Math.round(100*l)/100}function ve(e){t.style.transition="",t.style.opacity=0,t.offsetHeight,t.textContent=e,t.style.transition="all 3s ease",t.style.opacity=1}function Ie(t,e){st||ct||(st=1,T(1),dt=t+3500,H.map(l=>{e.push(ne(v(l,Rt,Tt),nt-Gt,it-Lt,1500,t))}),ve("Signal Lost"))}function Pe(t){let e=g.getBoundingClientRect();return[Math.floor(480*(t.pageX-e.left)/e.width),Math.floor(700*(t.pageY-e.top)/e.height)]}self.onmousedown=t=>{t.preventDefault(),rt=1},self.onmouseup=t=>{t.preventDefault(),rt=0},self.ontouchcancel=self.ontouchend=self.ontouchmove=self.ontouchstart=t=>{let e=t.touches;if(t.preventDefault(),et=e.length>1,null!=lt)for(let t=0;t<e.length;t++)if(e[t].identifier==lt){let[l,o]=Pe(e[t]);return ot+=l-_,at+=o-tt,_=l,void(tt=o)}if(e.length>0)return lt=e[0].identifier,void([_,tt]=Pe(e[0]));lt=null},self.onmousemove=t=>{t.preventDefault(),[ot,at]=Pe(t)},self.onkeydown=self.onkeyup=t=>{t.preventDefault(),kt[t.keyCode]=t.type[5]},q.width=480,q.height=700,function o(a){xt>1?(o=>{let a=o-Se;Se=o,a>200&&(Dt+=a-40,a=40,kt=[],rt=et=0);let n=o-Dt;if(3==xt&&!st&&!ct){let t=.6*a,e=be(0),l=be(1);if((kt[38]||kt[87]||kt[90]||xe(12))&&l--,(kt[40]||kt[83]||xe(13))&&l++,(kt[37]||kt[65]||kt[81]||xe(14))&&e--,(kt[39]||kt[68]||xe(15))&&e++,kt[13]||kt[32]||xe(0)||xe(1)||xe(2)||xe(3)||xe(9)||rt||et?St||(r=n,gt&&r>pt&&(gt--,jt(),T(1.5),pt=r+1e3,pe+=1500,me+=1500),St=1):St=0,e||l){let o=Math.max(Math.hypot(e,l),1);nt+=t*e/o,it+=t*l/o,ot=nt,at=it}else{let e=ot-nt,l=at-it,o=Math.hypot(e,l);o>t?(nt+=e/o*t,it+=l/o*t):(nt=ot,it=at)}Gt>nt?nt=Gt:nt>480-Gt&&(nt=480-Gt),Lt>it?it=Lt:it>700-Lt&&(it=700-Lt),ut=[nt,it,Rt,Tt,At]}var r;ct&&n+2500>dt&&(it+=.6*a*(dt-3e3-n)/2e3),2==xt&&(at=it=700+Lt-Math.min(1,2*n/2500)*(Tt+20)),z.fillStyle="#002",z.fillRect(0,0,1e9,1e9);for(let t,e=100;e--;z.fillStyle=W[e%W.length],S(z,-60*(1-e/100)*nt/(480-Rt)+102797*(1+Math.sin(t))*e%540,700*(Math.tan(e/9)+t*n/3e3)%700,3.3*(t-.3)))t=150/(3*e+200);let f=[],u=[],s=[];if(se.map(function t(e){let l=[],o=e(n,l,u);o&&(2==o?u.push(e):f.push(e),o.call&&s.push(o)),l.map(t)}),se=f.concat(u),ce=s,!st){if(mt){let t=j[Math.max(0,j.length-mt)];L(t,nt-Math.floor(t.width/2),it-Math.floor(t.height/2))}let t=Y[h(Math.random(),0,1)][0];L(t,nt-t.width/2,it+Lt-1),L(N,nt-Gt,it-Lt)}if(pt>n&&A(()=>{z.globalAlpha=(pt-n)/1e3,z.fillRect(0,0,1e9,1e9)}),3==xt&&!st&&!ct&&n>de+200){let[t,e]=K.u[1]>2?[Q,20]:[F,10];(K.u[1]&&!yt||K.u[1]>1&&1==yt)&&(se.push(ae(nt-25,it-Math.floor(Tt/2),t[0],0,e,n)),se.push(ae(nt+25,it-Math.floor(Tt/2),t[2],2,e,n)));let[l,o]=K.u[0]%2?[Q,20]:[F,10];K.u[0]>1?(se.push(ae(nt-12,it-Math.floor(Tt/2),l[1],1,o,n)),se.push(ae(nt+12,it-Math.floor(Tt/2),l[1],1,o,n)),2==K.u[0]&&se.push(ae(nt,it-Math.floor(Tt/2)-12,l[1],1,o,n))):se.push(ae(nt,it-Math.floor(Tt/2),l[1],1,o,n)),de=n,P([292,.08,.74,.01,3,-3.9,.43,.02]),yt=(yt+1)%4}if(n>me&&!ge&&(++Ct%6?me=n+1e4:ht-5&&(ge=1,se.push(Ce(n)))),!ge&&n>pe){let t=h(Me(),0,Math.min(Ct,$.length-1)),e=h(Me(),30,450),l=50*(t+1),o=(o,a)=>a.push((([t,e,l,o,a,n,i,r,f,u,s,c],d,M,p)=>{let g,S=t.width,C=t.height,w=-C/2,x=0,b=p,I=i&&p+i,k=0,D=st?0:he(d,w);function O(t,e,l){if(ee(t,g))return x=l,(a-=e)>0&&R(),1}return(i,c,p)=>{let R=i-b,U=400-i+x,B=0;if(0>=a||pt>i)B=1;else{if(s){if(!st&&it>w){let t=he(d,w)-D,e=Math.atan2(Math.sin(t),Math.cos(t)),l=s*R;D+=0>e?Math.max(e,-l):Math.min(e,l)}d+=R*n*Math.sin(D),w+=R*n*Math.cos(D)}else w+=R*n;!st&&f&&(w=Math.min(w,f)),g=[d,w,S,C,e],ee(ut,g)&&(le(i,p),st||(B=1))}if(B){T(S/275),u&&ue(c,u[0],u[1],d,w+17*n,2*Math.PI/u[2],u[2],i);let t=h(Math.random(),0,o.length/2);o.map((e,l)=>c.push(t-l?ne(v(e,S,C),d-S/2,w-C/2,500,i):(([t,e,l,o,a,n,i],r,h,f)=>{let u=r+t+l,s=h+e+o,c=f,d=Math.atan2(i,n),M=y(a).data,p=.2+.1*K.u[4],[g,S]=m(a.width,a.height);return S.drawImage(a,0,0),S.fillStyle="#fff",S.globalCompositeOperation="source-in",S.fillRect(0,0,g.width,g.height),t=>{let e=(t-c)/500,l=t-f,o=Math.hypot(nt-u,it-s);if(!st&&o<80*K.u[4]){let t=he(u,s);u+=Math.sin(t)*p*l,s+=Math.cos(t)*p*l}else 1>e&&(u+=3*(1-e)*Math.cos(d),s+=3*(1-e)*Math.sin(d),(0>u||u>480-a.width)&&(d+=Math.PI)),s+=.1*l;let n=[u,s,a.width,a.height,M];return!st&&ee(ut,n)?(qt(ht+1),void P([1675,.24,1,,1,,,,,,1.82,,,,,0,,.06,837])):s>700?void 0:(f=t,L(a,u-a.width/2,s-a.height/2),A(()=>{z.globalAlpha=.5+Math.sin(t/100)/2,L(g,u-a.width/2,s-a.height/2)}),1)}})(v(e,S,C),d-S/2,w-C/2,i)));for(let t=0;Math.ceil(S*C/500)>t;t++)c.push(re(d,w,S,C,i));return zt(M)}if(700>=w-C/2){if(L(t,d-S/2,w-C/2),U>0&&A(()=>{z.globalAlpha=U/400,L(l,d-S/2,w-C/2)}),!st&&I&&i>I){let t=w+17*n;G();let e=r((e,l,o,a)=>{let n=he(d,t);if(c.push(fe(e,d,t,n,l,i)),o)for(let r=0;o>r;r++)c.push(fe(e,d,t,n+(r+1)*a,l,i),fe(e,d,t,n-(r+1)*a,l,i))},(e,l,o,a)=>{ue(c,e,l,d,t,o,a,i)},++k);I=e&&I+e}return b=i,O}}})($[t],e,l,o));if($[t][11])for(let t=0;3>t;t++)se.push(oe(n+300*(t+1),o));o(n,se),pe+=Math.max(0,1e3-50*Ct)+Math.round(400*Me())}dt&&n>dt&&(l.style.width=e.style.opacity=i.textContent=p.textContent=b.textContent="",e.style.transition="initial",e.offsetHeight,e.style.transition="",(()=>{let t=[];t.push("You got "+wt.toLocaleString()+" points"),Mt&&t.push("New Top Score!"),ct?t.push(["Next, "+V[ht+1],()=>Xt(ht+1)]):t.push(["Try Again",()=>Xt(ht)]),t.push(["Upgrades",()=>Wt("Upgrades",Bt())]),wt&&t.push(["Tweet Score",()=>open("//twitter.com/intent/tweet?hashtags=js13k&url="+location+"&text="+encodeURIComponent("I got "+wt.toLocaleString()+" points in Galaxy Raid's "+V[ht]+" mission!"))]),t.push(Ot),Wt(ht-5?ct?ht-4?"Victory":"Total Victory!!":"Defeat":"Good Try",t)})(),xt=0),2==xt&&n>2500&&(xt=3,t.style.opacity=0,t.style.transition="all .5s ease",4==ht&&se.push(Ce(n)))})(a):(t=>{z.fillStyle="#002",z.fillRect(0,0,1e9,1e9);for(let e=100;e--;){z.fillStyle=W[e%W.length];let l=100/(4-(t/1e3+e/13)%4);S(z,Math.cos(e)*l+240,Math.sin(e*e)*l+350,l/100)}let e=be(1);kt[38]||kt[87]||kt[90]||xe(12)||-.8>e?Zt||(te(-1),Zt=1):Zt=0,kt[40]||kt[83]||xe(13)||e>.8?Kt||(te(1),Kt=1):Kt=0,kt[13]||kt[32]||xe(0)||xe(1)||xe(2)||xe(3)||xe(9)?_t||(document.activeElement.onpointerdown(),_t=1):_t=0,xt&&(ht-5&&(!bt.length||4==ht&&bt.length-Vt.length)?(()=>{let t=[...Vt[4==ht?bt.length:ht]],e=E(C(w(Yt[ht],...t)));bt.push(e),It.push(k(e)),Pt.push(x(e)),vt.push(y(e).data)})():ft==ht||5==ht&&ft<Qt.length?$.push(...Qt[ft++].map(t=>(([t,e,l,...o])=>{let a=C(E(w(Yt[ht],t,e,l)));return[a,y(a).data,k(a),x(a),...o]})(t))):(ve("Good Luck"),xt=2,Me=d(Ft[ht]),pe=3500,me=7500,se=[],ce=[],Se=Dt=performance.now(),gt=K.u[3],ge=4==ht,zt(st=ct=Ct=de=pt=wt=dt=yt=Mt=0),jt(),ot=nt=240,it=700+Lt,mt=K.u[2]))})(a),requestAnimationFrame(o)}(Dt);</script>