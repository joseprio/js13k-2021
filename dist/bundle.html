<!doctype html><title>Galaxy Raid</title><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1.01"><meta name=monetization content=$ilp.uphold.com/ARgDFUGHFJ8Y><style>body,html{width:100%;height:100%;margin:0;padding:0;background:#000;overflow:hidden}#b,#g,#i,#p,#s,#t,body,html{touch-action:none;user-select:none;-webkit-user-select:none}#h,body{display:flex;align-items:center;justify-content:center}#g,#h{position:absolute;transform:scale(var(--s,.1));width:480px;height:700px;flex-direction:column}#b,#e,#i,#p,#s{position:absolute;font-size:20px}#i,#p,#s{top:0}#e{top:40px;height:15px;outline:3px solid #fff;border:2px solid transparent;transition:all .5s linear;opacity:0}#l{opacity:.6}#e,#i,#p{right:0}#b,#e,#p,#s{left:0}#b{bottom:0;transform:none}#c,#p{text-align:center}#e,button,p{color:#fff;font:400 30px Futura,"Trebuchet MS",Arial;transform:skew(6rad) scaleX(.7);margin:5px}#t{font-size:45px;text-transform:uppercase;text-shadow:0 0 5px #fff,0 0 20px #0ff}#t.b{font-size:70px}button{outline:3px solid #0ff;width:350px;height:50px;border:2px solid transparent;background:0 0;cursor:pointer;transition:all .3s ease;position:relative;margin:10px}button[d]{opacity:.5;outline-color:red}#l,button:before{position:absolute;top:0;bottom:0;left:0;width:0;transition:inherit;content:'';background:#0ff;z-index:-1}button:focus{color:#002}button:focus:before{width:100%}</style><canvas id=g></canvas><div id=h><p id=p><p id=s><div id=e><div id=l></div></div><p id=i><p id=b><p id=t><div id=c></div></div><script>function a(t,e,l){return Math.max(e,Math.min(l,t))}function o(t,e){return`rgb(${t.map(t=>t*e*100).join("%,")}%)`}function n(t,e,l){let a=(a,o=(a+6*t)%6)=>l-l*e*Math.max(Math.min(o,4-o,1),0);return[a(5),a(3),a(1)]}function r(t,e,l){return t*(l-e)+e}function h(t,e,l){return Math.floor(r(t,e,l+1))}function f(t,e,l){let a=0;for(;t()<e&&l>a;)a++;return a}function u(t,e){let l=0;for(let t=0;t<e.length;t++)l+=e[t];let a=t()*l;for(let t=0;t<e.length;t++)if(a-=e[t],0>=a)return t}function d(t){let e=new Uint32Array([Math.imul(t,2246822507),Math.imul(t,3266489909)]);return()=>{let t=e[0],l=e[1]^t;return e[0]=(t<<26|t>>8)^l^l<<9,e[1]=l<<13|l>>19,(Math.imul(t,2654435771)>>>0)/4294967295}}function M(t){return t.getContext("2d")}function m(t,e){let l=document.createElement("canvas");return l.width=t,l.height=e,[l,M(l)]}function S(t,e,l,a){t.beginPath(),t.arc(e,l,a,0,7),t.fill()}function y(t){return M(t).getImageData(0,0,t.width,t.height)}function C(t){let e,l,a,o,n=M(t),i=y(t);a=o=0,e=l=1e9;for(let t=0;t<i.width;t++)for(let n=0;n<i.height;n++)i.data[4*(n*i.width+t)+3]&&(e=Math.min(e,t),l=Math.min(l,n),a=Math.max(a,t),o=Math.max(o,n));let r=n.getImageData(e,l,1+a-e,1+o-l);return t.width=r.width,t.height=r.height,n.putImageData(r,0,0),t}function w(t,e,l,i){let s=d(l),M=d(t),c=d(e),p=[.8*r(c(),.001,1)*2**(8*c()),.9*r(c(),.001,1)*2**(8*c()),1*r(c(),.001,1)*2**(8*c()),3*c()*2**(8*c()),.5*c()*2**(8*c()),.05*c()*2**(8*c()),.5*c()*2**(8*c())],g=[],C=[],w=1+(.7>M()?1:0)+f(M,.3,3);for(let t=0;w>t;t++)g.push(n(M()**2,a(r(M(),-.2,1),0,M()**4),Math.max(r(M(),.7,1.1),1))),C.push(2**(6*M()));let x=M()/2,b=r(M(),0,.6),v=r(M(),0,.6),I=r(M(),0,.6),P=Math.floor(3*s()),R=i||r(s(),2.5,7)**3,T=r(s(),.5,1.3),G=r(s(),.7,1.7),L=r(s(),.1,1),A=r(s(),2,8),k=r(s(),.5,1.5),D=r(s(),.1,1),O=r(s(),10,50),U=r(s(),.5,1.5),B=r(s(),.03,.1),E=s()>.5?"round":"square",$=r(s(),.1,1),N=s(),H=c()>.5?1:2,W=c()/H,q=c(),z=c(),j=r(c(),-.2,1.2),J=c(),V=c(),Y=r(c(),.5,.8),F=Y-r(c(),.2,.4),Q=r(c(),0,.2),X=u(c,C),K=r(c(),.02,.1),Z=c(),_=c(),tt=c(),et=r(c(),2,6),lt=r(c(),2,7),at=c(),ot=c(),nt=c(),it=c(),rt=c(),ht=r(c(),0,.8),ft=r(c(),.5,1.5),ut=c(),st=r(c(),.2,.9),dt=r(c(),-.2,-.05),Mt=r(c(),.1,3.5),ct=p.map(c),pt=p.map(c);function mt(){let t=g[u(M,C)];return M()<x**2?[a(t[0]+b**2*a(r(M(),-1,1.2),0,1)*a((.7>M()?-1:1)+(.7>M()?-1:1),-1,1),0,1),a(t[1]+v**2*a(r(M(),-1,1.2),0,1)*a((.7>M()?-1:1)+(.7>M()?-1:1),-1,1),0,1),a(t[2]+I**2*a(r(M(),-1,1.2),0,1)*a((.7>M()?-1:1)+(.7>M()?-1:1),-1,1),0,1)]:t}let gt=Math.floor(R*T),St=Math.floor(gt/2),yt=Math.floor(gt/6),Ct=(gt-6*yt)/2,wt=Math.floor(R*G),xt=Math.floor(wt/2),bt=Math.floor(wt/6),vt=(wt-6*bt)/2,[It,Pt]=m(gt,wt),Rt=gt*wt/20;if(0==P){let t=Math.ceil(gt*L/5),e=[[[St-t,0],[St+t,wt]]],l=2+Math.floor(r(s(),.5,1)*A*R**.5);for(let t=1;l>t;t++){let t=e[h(s(),0,e.length-1)],l=[t[0][0]+s()*(t[1][0]-t[0][0]),t[0][1]+s()*(t[1][1]-t[0][1])];l[1]<(t[0][1]+t[1][1])/2&&s()<k&&(l[1]=t[1][1]-(l[1]-t[0][1]));let a=[s()*gt,s()*wt],o=Rt/Math.abs((a[0]-l[0])*(a[1]-l[1]));if(1>o&&(a[0]=l[0]+(a[0]-l[0])*o,a[1]=l[1]+(a[1]-l[1])*o),l[0]>a[0]){let t=l[0];l[0]=a[0],a[0]=t}if(l[1]>a[1]){let t=l[1];l[1]=a[1],a[1]=t}e.push([[Math.floor(l[0]),Math.floor(l[1])],[Math.ceil(a[0]),Math.ceil(a[1])]])}Pt.fillStyle="#fff",e.map(t=>{Pt.fillRect(t[0][0],t[0][1],t[1][0]-t[0][0],t[1][1]-t[0][1]),Pt.fillRect(gt-t[1][0],t[0][1],t[1][0]-t[0][0],t[1][1]-t[0][1])})}else if(1==P){let t=Math.max(2,(Rt/Math.PI)**.5),e=Math.ceil(gt*D/5),l=[],a=Math.floor(wt/(2*e));for(let t=0;a>t;t++){let a=[St,wt-e*(2*t+1)];l.push({v:a,r:e})}let o=a+Math.floor(r(s(),.5,1)*O*R**.5);for(let e=a;o>e;e++){let e=l[Math.max(h(s(),0,l.length-1),h(s(),0,l.length-1))],a=r(s(),1,t),o=r(s(),Math.max(0,e.r-a),e.r),n=r(s(),0,2*Math.PI);n>Math.PI&&s()<U&&(n=r(s(),0,Math.PI));let i=[e.v[0]+Math.cos(n)*o,e.v[1]+Math.sin(n)*o];a=Math.min(a,i[0],gt-i[0],i[1],wt-i[1]),l.push({v:i,r:a})}Pt.fillStyle="#fff",l.map(t=>{S(Pt,t.v[0],t.v[1],t.r),S(Pt,gt-t.v[0],t.v[1],t.r)})}else{let t=[[St,r(s(),0,.05)*wt],[St,r(s(),.95,1)*wt]],e=6/R+B,l=Math.max(3,Math.ceil(r(s(),.05,.1)/e*R**.5));Pt.lineCap=E,Pt.strokeStyle="#fff";for(let a=1;l>a;a++){let l=t[a];l||(l=[s()*gt,s()**$*wt],t.push(l));let o=1+f(s,N,3);for(let a=0;o>a;a++){let a=t[h(s(),0,t.length-2)];Pt.lineWidth=r(s(),.7,1)*e*R,Pt.beginPath(),Pt.moveTo(a[0],a[1]),Pt.lineTo(l[0],l[1]),Pt.stroke(),Pt.beginPath(),Pt.moveTo(gt-a[0],a[1]),Pt.lineTo(gt-l[0],l[1]),Pt.stroke()}}}let Tt=y(It);function Gt(t,e){return Tt.data[4*(e*gt+t)+3]}let Lt=[];for(let t=0;yt>t;t++){Lt[t]=[];for(let e=0;bt>e;e++)Lt[t][e]=[t,e,Math.floor(Ct+6*(t+.5)),Math.floor(vt+6*(e+.5))]}let At=[Lt[Math.floor(yt/2)][Math.floor(bt/2)]];for(let t=0;t<At.length;t++){let e=At[t];if(e[0]>0){let t=Lt[e[0]-1][e[1]];t[4]||(Gt(t[2],t[3])?(t[4]=1,At.push(t)):t[4]=2)}if(e[0]<yt-1){let t=Lt[e[0]+1][e[1]];t[4]||(Gt(t[2],t[3])?(t[4]=1,At.push(t)):t[4]=2)}if(e[1]>0){let t=Lt[e[0]][e[1]-1];t[4]||(Gt(t[2],t[3])?(t[4]=1,At.push(t)):t[4]=2)}if(e[1]<bt-1){let t=Lt[e[0]][e[1]+1];t[4]||(Gt(t[2],t[3])?(t[4]=1,At.push(t)):t[4]=2)}}for(let t=0;t<At.length;t++){let e=At[t],l=Lt[yt-1-e[0]][e[1]];1!=l[4]&&(l[4]=1,At.push(l))}let kt=Math.max(1,Math.floor(At.length*W)),Dt=H*At.length+kt;function Ot(t,e){let l=Math.floor((t-Ct)/6),a=Math.floor((e-vt)/6);if(l>=0&&yt>l&&a>=0&&bt>a)return 1==Lt[l][a][4]}function Ut(t){return 1-t[1]/wt}function Bt(t,e){let l=Math.min(1,1-Math.abs(t[0]-St)/St);return e&&(l=Math.min(l,1-Math.abs(t[1]-xt)/xt)),l}function Et(t,e,l,a,o,n,i){let h=(Bt(e,1)*(1-1/((gt+wt)/1e3+1))*q**.5*(1-zt/Dt))**l,f=8;if(c()<r(ct[t],a,o)*h){let l=r(pt[t],n,i);for(;c()<l*h&&f/2<Math.min(e[0]-f,gt-e[0]-f,e[1]-f,wt-e[1]-f);)f*=1.5}return f}function $t(t,e,l){let a=Pt.createLinearGradient(e[0],e[1],2*t[0]-e[0],2*t[1]-e[1]),o=`rgba(0,0,0,${l})`;return a.addColorStop(0,o),a.addColorStop(.5,"rgba(0,0,0,0)"),a.addColorStop(1,o),a}It.width|=0;let Nt=[t=>{let e=Et(0,t,.3,0,.9,0,.5),l=2*e,n=Math.ceil(r(c(),1,Math.max(2,e/2))),i=Math.ceil(r(c(),1,Math.max(2,e/2))),h=Math.min(n,i)*r(c(),.1,1.2),f=n+2*h,u=i+2*h,s=Math.ceil(l/f),d=Math.ceil(l/u),M=Math.round(s*f/2),p=Math.round(d*u/2),m=mt();Pt.fillStyle=`rgba(0,0,0,${r(c(),0,.25)})`,Pt.fillRect(t[0]-M-1,t[1]-p-1,f*s+2,u*d+2),Pt.fillStyle=o(m,r(c(),.4,1)),Pt.fillRect(t[0]-M,t[1]-p,f*s,u*d),Pt.fillStyle=o(m,r(c(),.4,1));for(let e=0;s>e;e++){let l=t[0]+h+e*f-M;for(let e=0;d>e;e++){let a=t[1]+h+e*u-p;Pt.fillRect(l,a,n,i)}}c()<a(e/8*(.6*zt/Dt+.3),0,.98)&&(Pt.fillStyle=$t(t,[t[0]+M,t[1]],r(c(),0,.9)),Pt.fillRect(t[0]-M,t[1]-p,f*s,u*d))},t=>{let e=Et(1,t,.2,.3,1,0,.6),l=Math.ceil(r(c(),.8,2)*e),n=Math.ceil(r(c(),.8,2)*e),i=h(c(),3,Math.max(4,l)),f=Math.max(1,Math.round(l/i)),u=f*i,s=o(mt(),r(c(),.5,1)),d=r(c(),.3,.9);if(c()<a(j,0,1)){let e=[t[0]-Math.floor(u/2),t[1]-Math.floor(n/2)];Pt.fillStyle=`rgba(0,0,0,${r(c(),0,.25)})`,Pt.fillRect(e[0]-1,e[1]-1,u+2,n+2),Pt.fillStyle=s,Pt.fillRect(e[0],e[1],u,n);for(let l=0;f>l;l++)Pt.fillStyle=$t([e[0]+(l+.5)*i,t[1]],[e[0]+l*i,t[1]],d),Pt.fillRect(e[0]+l*i,e[1],i,n)}else{let e=[t[0]-Math.floor(n/2),t[1]-Math.floor(u/2)];Pt.fillStyle=`rgba(0,0,0,${r(c(),0,.25)})`,Pt.fillRect(e[0]-1,e[1]-1,n+2,u+2),Pt.fillStyle=s,Pt.fillRect(e[0],e[1],n,u);for(let l=0;f>l;l++)Pt.fillStyle=$t([t[0],e[1]+(l+.5)*i],[t[0],e[1]+l*i],d),Pt.fillRect(e[0],e[1]+l*i,u,i)}},t=>{let e=Et(2,t,.05,0,1,0,.9),l=Math.ceil(r(c(),.6,1.4)*e),n=Math.ceil(r(c(),1,2)*e),i=Math.ceil(Math.max(l*r(c(),.7,1)/2,1)),h=Math.ceil(Math.max(l*r(c(),.8,1)/2,1)),f=Math.floor(a(l*r(c(),.05,.25),1,n)),u=Math.floor(a(l*r(c(),.1,.3),1,n)),s=f+u,d=c()<J**.5,M=Math.max(Math.floor(n/s),1),p=M*s+(d?f:0),m=mt(),g=r(c(),.6,1),S=r(c(),.6,1),y=o(m,g),C=o(m,S),w=1-r(c(),.5,.95),x=o(m,w*g),b=o(m,w*S);if(c()<V**.1){let e=Pt.createLinearGradient(t[0]-i,t[1],t[0]+i,t[1]),l=Pt.createLinearGradient(t[0]-h,t[1],t[0]+h,t[1]),a=Math.floor(t[1]-p/2);e.addColorStop(0,x),e.addColorStop(.5,y),e.addColorStop(1,x),l.addColorStop(0,b),l.addColorStop(.5,C),l.addColorStop(1,b);for(let o=0;M>o;o++)Pt.fillStyle=e,Pt.fillRect(t[0]-i,a+o*s,2*i,f),Pt.fillStyle=l,Pt.fillRect(t[0]-h,a+o*s+f,2*h,u);d&&(Pt.fillStyle=e,Pt.fillRect(t[0]-i,a+M*s,2*i,f))}else{let e=Pt.createLinearGradient(t[0],t[1]-i,t[0],t[1]+i),l=Pt.createLinearGradient(t[0],t[1]-h,t[0],t[1]+h),a=Math.floor(t[0]-p/2);e.addColorStop(0,x),e.addColorStop(.5,y),e.addColorStop(1,x),l.addColorStop(0,b),l.addColorStop(.5,C),l.addColorStop(1,b);for(let o=0;M>o;o++)Pt.fillStyle=e,Pt.fillRect(a+o*s,t[1]-i,f,2*i),Pt.fillStyle=l,Pt.fillRect(a+o*s+f,t[1]-h,u,2*h);d&&(Pt.fillStyle=e,Pt.fillRect(a+M*s,t[1]-i,f,2*i))}},t=>{if(c()<Ut(t)-.3||Ot(t[0],t[1]+6*1.2)||Ot(t[0],t[1]+10.8))for(;;){let e=u(c,p);if(3!=e)return void Nt[e](t)}let e=Et(3,t,.1,.6,1,.3,.8),l=r(c(),1,2)*e,a=Math.ceil(r(c(),.3,1)*e),n=l*r(c(),.25,.6),i=(l+n)/4,h=Math.max(1,Math.ceil(a*r(c(),.08,.25))),f=h+Math.max(1,Math.ceil(a*r(c(),.03,.15))),s=Math.ceil(a/f),d=s*f+h,M=g[X],m=Pt.createLinearGradient(t[0]-i,t[1],t[0]+i,t[1]),S=Pt.createLinearGradient(t[0]-i,t[1],t[0]+i,t[1]),y=Math.ceil(t[1]-d/2),C=y+h,w=y+f;m.addColorStop(0,o(M,F)),m.addColorStop(.5,o(M,Y)),m.addColorStop(1,o(M,F)),S.addColorStop(0,o(M,Q)),S.addColorStop(.5,o(M,1)),S.addColorStop(1,o(M,Q)),Pt.fillStyle=m,Pt.beginPath(),Pt.moveTo(t[0]-n/2,y),Pt.lineTo(t[0]+n/2,y),Pt.lineTo(t[0]+l/2,y+d),Pt.lineTo(t[0]-l/2,y+d),Pt.fill(),Pt.fillStyle=S;for(let e=0;s>e;e++){let a=[C+e*f,w+e*f],o=[(n+(e*f+h)/d*(l-n))/2,(n+(e+1)*f/d*(l-n))/2];Pt.beginPath(),Pt.moveTo(t[0]-o[0],a[0]),Pt.lineTo(t[0]+o[0],a[0]),Pt.lineTo(t[0]+o[1],a[1]),Pt.lineTo(t[0]-o[1],a[1]),Pt.fill()}},t=>{let e,l=Bt(t,0),a=r(c(),.7,1),n=r(c(),0,.2),i=mt(),f=o(i,a),s=o(i,n),d=Math.max(3,Math.ceil(R*r(c(),.4,1)**2*K)),M=Math.floor(d/2),p=d%2,m=u(c,[Z**4*(2-l),.1*_**4,.2*tt**4*(1+l)]);if(m)if(2>m){let l=wt-t[1],a=Math.min(Math.max(8,l-h(c(),0,16)),Math.floor(.6*R*c()**lt)),o=t[0]-M,n=t[1],i=t[0]+M+p,r=Pt.createLinearGradient(o,n,i,n);r.addColorStop(0,s),r.addColorStop(.5,f),r.addColorStop(1,s),Pt.fillStyle=r,Pt.fillRect(o,n,d,a),e=[t[0],t[1]+a]}else{let l=Pt.createLinearGradient(t[0],t[1]-M,t[0],t[1]+M+p);l.addColorStop(0,s),l.addColorStop(.5,f),l.addColorStop(1,s),Pt.fillStyle=l,Pt.fillRect(t[0],t[1]-M,Math.ceil(St-t[0])+1,d),e=[St,t[1]]}else{let l=t[1],a=Math.min(Math.max(8,l-h(c(),0,16)),Math.floor(.7*R*c()**et)),o=t[0]-M,n=t[1]-a,i=t[0]+M+p,r=Pt.createLinearGradient(o,n,i,n);r.addColorStop(0,s),r.addColorStop(.5,f),r.addColorStop(1,s),Pt.fillStyle=r,Pt.fillRect(o,n,d,a),e=[t[0],t[1]-a]}let g=[.6*at**2,.2*ot**2,nt**2];if(Nt[u(c,g)](t),Ot(e[0],e[1])){let t=[e[0]+Math.round(6*r(c(),-1,1)),e[1]+Math.round(6*r(c(),1,1))];Nt[u(c,g)](Ot(t[0],t[1])?t:e)}},t=>{let e=Et(5,t,.1,0,.9,0,.8),l=r(c(),.75,1),a=r(c(),0,.25),n=mt(),i=o(n,l),h=o(n,a),u=1+f(c,it,Math.floor(1.2*(e/8)**.6)),s=1+f(c,rt,Math.floor(1.2*(e/8)**.6)),d=r(c(),.5,1)*e/Math.max(u,s),M=d+.5,p=[t[0]-d*u,t[1]-d*s];Pt.fillStyle=`rgba(0,0,0,${r(c(),0,.2)})`;for(let t=0;u>t;t++){let e=p[0]+(2*t+1)*d;for(let t=0;s>t;t++)S(Pt,e,p[1]+(2*t+1)*d,d+1)}for(let t=0;u>t;t++){let e=p[0]+(2*t+1)*d;for(let t=0;s>t;t++){let l=p[1]+(2*t+1)*d,a=Pt.createRadialGradient(e,l,d/5,e,l,M);a.addColorStop(0,i),a.addColorStop(1,h),Pt.fillStyle=a,S(Pt,e,l,M)}}},t=>{if(0>=Wt||c()<Ut(t))return void Nt[u(c,p.slice(0,6))](t);let e=Et(6,t,.05,0,.9,0,.8),l=Math.ceil(2*e*r(c(),.6,1)),a=Math.floor(l/2),n=l%2,i=l*r(c(),ht**.5,.9)**ft,h=Math.floor(i/2),f=Math.max((i-l)/2,l*(r(c(),0,.45)+r(c(),0,.45))*(.8>ut?st:dt)),s=Math.ceil(e*r(c(),.7,1)*Mt**.5),d=Math.floor(s/2),M=s%2,m=[[t[0]-d,t[1]+f-h],[t[0]+d+M,t[1]-a],[t[0]+d+M,t[1]+a+n],[t[0]-d,t[1]+f+h+l%2]],g=mt();Pt.fillStyle=`rgba(0,0,0,${r(c(),0,.2)})`,Pt.beginPath(),Pt.moveTo(m[0][0]-1,m[0][1]),Pt.lineTo(m[1][0]-1,m[1][1]),Pt.lineTo(m[2][0]-1,m[2][1]),Pt.lineTo(m[3][0]-1,m[3][1]),Pt.fill(),Pt.fillStyle=o(g,r(c(),.7,1)),Pt.beginPath(),Pt.moveTo(m[0][0],m[0][1]),Pt.lineTo(m[1][0],m[1][1]),Pt.lineTo(m[2][0],m[2][1]),Pt.lineTo(m[3][0],m[3][1]),Pt.fill()}],Ht=0,Wt=0,qt=0,zt=0;for(;;){let t;if(H>Wt)qt<At.length?(t=At[qt],qt++):(Wt++,t=At[0],qt=1);else{if(Ht>=kt)break;t=At[h(c(),0,At.length-1)],Ht++}let e=[t[2],t[3]];for(let l=0;10>l;l++){let l=[t[2]+h(c(),-6,6),t[3]+h(c(),-6,6)];if(!(0>l[0]||l[0]>gt||0>l[1]||l[1]>wt)&&Gt(l[0],l[1])){e=l;break}}6>Math.abs(e[0]-St)&&c()<z&&(e[0]=St),Nt[u(c,p)](e),zt++}return Pt.clearRect(gt-St,0,St,wt),Pt.scale(-1,1),Pt.drawImage(It,-gt,0),It}function x(t){let e=t.width,l=t.height,a=Math.max(12,Math.floor(Math.min(e,l)/12)),o=y(t),n=Math.floor(e/a),i=Math.floor(l/a),r=[],h=Math.floor(l/i/2);for(let t=0;i>t;t++){let a=Math.floor(e/((2-t%2)*n));for(let o=0;n-t%2>o;o++)r.push([1e9,1e9,0,0,a+(o+(Math.random()-.5))*e/n,h+(t+(Math.random()-.5))*l/i,[]])}for(let t=0;l>t;t++)for(let l=0;e>l;l++){let a=4*(t*e+l);if(o.data[a+3]){let e,n=1e9;r.map(a=>{let o=Math.hypot(a[4]-l,a[5]-t);n>o&&(n=o,e=a)}),e[0]=Math.min(l,e[0]),e[2]=Math.max(l,e[2]),e[1]=Math.min(t,e[1]),e[3]=Math.max(t,e[3]),e[6].push([l,t,o.data.slice(a,a+4)])}}let f=[];return r.sort((t,e)=>e[6].length-t[6].length).map(t=>{if(1e9>t[0]){let e=t[2]-t[0]+1,l=t[3]-t[1]+1,[a,o]=m(e,l),n=y(a);t[6].map(l=>n.data.set(l[2],4*((l[1]-t[1])*e+(l[0]-t[0])))),o.putImageData(n,0,0),f.push([t[4],t[5],t[0]-t[4],t[1]-t[5],a])}}),f}function v(t,e,l){let a=t[0]-e/2,o=t[1]-l/2,n=Math.hypot(a,o),i=n**2,r=n*(.5+1.5*Math.random());return[...t,r*(1-o**2/i)**.5*(a>0?1:-1),r*(1-a**2/i)**.5*(o>0?1:-1),3*(Math.random()-.5)]}let I=new(window.AudioContext||webkitAudioContext),P=([t,e,l,a=0,o=0,n=.04,i=0,r=0,h=0,f=4,u=.06,s=0,d=0,M=.1,c=.04,p=0,m=0,g=0,S=0])=>{let y,C,w,x,b=2*Math.PI,v=h*=500*b/44100/44100,P=t*=(1+0*Math.random()-0)*b/44100,R=[],T=0,G=0,L=0,A=1,k=0,D=0,O=0;for(p*=500*b/44100**3,a*=b/44100,S*=b/44100,g*=44100,m=44100*m|0,C=(s=44100*s+9)+(n*=44100)+(u*=44100)+(e*=44100)+(d*=44100)|0;C>L;R[L++]=O)++D%(100*o|0)||(O=f?f>1?f>2?f>3?Math.sin((T%b)**3):Math.max(Math.min(Math.tan(T),1),-1):1-(2*T/b%2+2)%2:1-4*Math.abs(Math.round(T/b)-T/b):Math.sin(T),O=(m?1-i+i*Math.sin(b*L/m):1)*(O>0?1:-1)*Math.abs(O)**M*c*.3*(s>L?L/s:s+n>L?1-(L-s)/n*(1-l):s+n+u>L?l:C-d>L?(C-L-d)/e*l:0),O=d?O/2+(d>L?0:(C-d>L?1:(C-L)/d)*R[L-d|0]/2):O),y=(t+=h+=p)*Math.cos(a*G++),T+=y-y*r*(1-1e9*(Math.sin(L)+1)%2),A&&++A>g&&(t+=S,P+=S,A=0),!m||++k%m||(t=P,h=v,A||=1);return w=I.createBuffer(1,C,44100),w.getChannelData(0).set(R),x=I.createBufferSource(),x.buffer=w,x.connect(I.destination),x.start(),x};function R(){P([467,.14,.58,303,.4,.02,.02,.5])}function T(t){P([274,.67,.63,,.5,.02,,.8,,,.03,,.25,1.11,t,,.04])}function G(){P([279,.09,.89,,,,.02,,-4.9,3,.09,.02,.05,1.2,.15,-.6])}function L(t,e,l){z.drawImage(t,Math.round(e),Math.round(l))}function A(t){z.save(),t(),z.restore()}function k(t){let[e,l]=m(t.width,t.height),a=y(t),o=a.data;for(let t=0;t<o.length;t+=4){let[e,l,a]=o.slice(t,t+4);o.set([255-(.393*e+.769*l+.189*a),255-(.349*e+.686*l+.168*a),255-(.272*e+.534*l+.131*a)],t)}return l.putImageData(a,0,0),e}function D(t,e){return O(t,e,6,"#0ff","#00f")}function O(t,e,l,a,o){let[n,i]=m(20*t,20*t);return i.translate(9*t,9*t),i.rotate(e),i.fillStyle="#ff0",i.beginPath(),i.moveTo(t,t*l),i.lineTo(0,t),i.arc(t,t,t,Math.PI,0),i.lineTo(t,t*l),i.fill(),i.strokeStyle=a,i.shadowColor=o,i.globalCompositeOperation="source-atop",i.shadowBlur=Math.round(t/2),i.lineWidth=t/2,i.beginPath(),i.moveTo(t,t*l),i.lineTo(0,t),i.arc(t,t,t,Math.PI,0),i.lineTo(t,t*l),i.stroke(),n=C(n),[n,y(n).data]}function U(t,e){let[l,a]=m(t,t),o=a.createRadialGradient(t/2,t/2,0,t/2,t/2,t/2);return o.addColorStop(e,"#ff0"),o.addColorStop(1,"#f00"),a.fillStyle=o,S(a,t/2,t/2,t/2),l}function B(t){let e=[];for(let l=9;l--;)e.unshift(U(t,l/10)),e.push(U(t,l/10));return[e,y(e[0]).data]}function E(t){let[e,l]=m(t.width,t.height);return l.scale(1,-1),l.drawImage(t,0,0,t.width,-t.height),e}let $,N,H,W=["#9af","#abf","#ccf","#fef","#fee","#fc9","#fc6"],q=g,z=M(q),j=[],J=["Main Gun","Side Cannon","Shield","Bombs","Magnet"],V=["Andromeda","Borealis","Cygnus","Draco","Endgame","Survival"],Y=[O(5,0,4,"#f80","#f00"),O(4,0,4,"#f80","#f00")],F=[D(5,-.245),D(5,0),D(5,.245)],Q=[D(8,-.245),D(8,0),D(8,.245)],X=[B(8),B(14),B(20),B(28)],K=JSON.parse(localStorage["Galaxy Raid"]||0)||{l:0,s:0,u:J.map(()=>0)};function Z(){N=C(w(K.c||1301,5,114,40)),H=x(N)}Z();let _,tt,et,lt,at,ot,nt,it,rt,ht,ft,ut,st,dt,Mt,ct,pt,mt,gt,St,yt,Ct,wt,xt,bt,vt,It,Pt=N.width,Rt=N.height,Tt=Math.floor(Pt/2),Gt=Math.floor(Rt/2),Lt=y(N).data,At=[],kt=performance.now(),Dt=["\u21e6 Main Menu",Bt];function Ot(t,e){let l=Math.min(500,10**(K.u[e]+1)),a=[];!e||K.u[e]?a.push("Quality: "+(K.u[e]?"\u2b50".repeat(K.u[e]):"Standard")):a.push("Not Acquired"),4>K.u[e]&&a.push([(!e||K.u[e]?"Upgrade":"Buy")+": "+l.toLocaleString()+" \u267a",l<=K.s&&(()=>{K.u[e]++,Wt(-l),Ot(t,e)})]),a.push(["\u21e6 Back",()=>Ht("Upgrades",Ut(),e)]),Ht(t,a)}function Ut(){return[...J.map((t,e)=>["\u2b50".repeat(K.u[e])+" "+t,()=>Ot(t,e)]),["Refund All Upgrades",K.u.some(t=>!!t)?()=>{let t=0;K.u=K.u.map(e=>{for(let l=1;e>=l;l++)t+=Math.min(500,10**l);return 0}),Wt(t),Ht("Upgrades",Ut(),0)}:0],Dt]}function Bt(){let t=[["Play",Et],["Upgrades",()=>Ht("Upgrades",Ut())],["Top Scores",K[0]?()=>Ht("Top Scores",(()=>{let t=[];for(let e=0;K[e];e++)t.push("\u{1f3c6} "+V[e]+": "+K[e].toLocaleString()+" points");return t.push(Dt),t})()):0],["Supporter Options",()=>Ht("Supporter Options",$t())]];Ht("Galaxy Raid",t,0,1)}function Et(){let t=[];for(let e=0;6>e;e++){let l=e;t.push(e>K.l?["\u{1f512} "+V[l]]:[V[l],()=>Qt(l)])}t.push(Dt),Ht("Select Mission",t,K.l)}function $t(){let t=[],e="started"==document.monetization?.state;return e||t.push("Coil not detected"),t.push(["Ship Color",e&&(()=>Ht("Ship Color",Nt()))]),t.push(["Claim "+1e3.toLocaleString()+" \u267a",e&&!K.f&&(()=>{Wt(1e3),K.f=1,jt(),Ht("Supporter Options",$t())})]),t.push(["Unlock All Missions",e&&K.l-5&&(()=>{K.l=5,jt(),Ht("Supporter Options",$t())})]),t.push(Dt),t}function Nt(){return[N,["Randomize",()=>{K.c=h(Math.random(),0,1e9),jt(),Z(),Ht("Ship Color",Nt())}],["\u21e6 Back",()=>Ht("Supporter Options",$t())]]}function Ht(e,l,a=0,o){let n;t.style.transition="",t.className=o?"b":"",t.textContent=e,c.textContent="",l&&l.map((t,e)=>{if(t.map){let l=document.createElement("button");l.textContent=t[0],t[1]?l.onpointerdown=e=>{e?.preventDefault(),t[1]()}:l.setAttribute("d",""),c.appendChild(l),n||a>e||l.hasAttribute("d")||(n=l.style.transition="none",l.focus(),l.offsetHeight,l.style.transition="")}else if(t.width){let e=document.createElement("div");e.appendChild(t),c.appendChild(e)}else{let e=document.createElement("p");e.textContent=t,c.appendChild(e)}})}function Wt(t){K.s+=t,jt(),s.textContent="\u267a: "+K.s.toLocaleString()}Bt(),Wt(0),(self.onorientationchange=self.onresize=()=>{document.documentElement.style.setProperty("--s",Math.min(innerWidth/480,innerHeight/700))})();for(let t=0;10>t;t++){let[e,l]=m(Pt+20,Rt+20),a=t?0:10;for(let t=-1;2>t;t++)for(let e=-1;2>e;e++)l.drawImage(j[0]||N,e+a,a+t);l.globalCompositeOperation="source-in",l.fillStyle=t>5?"#0ff":"#00f",l.fillRect(0,0,1e9,1e9),l.globalCompositeOperation="source-over",t&&l.drawImage(j[0],0,0),j.unshift(e)}function qt(t){wt+=t,p.textContent=wt.toLocaleString(),K[ht]&&wt<=K[ht]||(K[ht]=wt,jt(),ct=1),i.textContent="TOP: "+K[ht].toLocaleString()}function zt(){b.textContent="\u{1f4a5} ".repeat(gt)}function jt(){localStorage["Galaxy Raid"]=JSON.stringify(K)}j.map(t=>{let e=M(t);e.globalCompositeOperation="destination-out",e.globalAlpha=.2;for(let t=5;9>t;t++)e.drawImage(j[t],0,0)}),j.length=5;let Jt=[[34,145,300],[141,50,200],[1905,111,220],[2514,491,220],[2066,334,300],[269,101,250]],Vt=[12,255,552,589,308,8],Yt=[1,2e3,3e3,4e3,0,6e3],Ft=[[[34,213,0,15,.35],[34,9,80,30,.35,1e3,t=>t(0,.3)],[34,18,100,50,.25,1e3,(t,e,l)=>(t(0,.3),l%3?250:1e3),150],[34,73,310,100,.15,0,0,0,[1,8,.45]]],[[20,18,40,30,.35,700,t=>t(0,.3)],[20,91,80,60,.3,550,(t,e,l)=>{if(e(0,8,Math.PI/8,.3),3>l)return 200}],[20,9,120,140,.15,800,(t,e,l)=>{let a=l%3;return t(1,.3),a?250:1e3}],[109,203,40,80,.55,0,0,0,0,.002]],[[51,91,120,120,.15,0,0,0,[1,11,.45]],[51,9,60,30,.4,800,t=>t(0,.3),0,0,0,1],[51,156,100,120,.35,800,(t,e,l)=>{let a=l%4;return t(1,.3+(l-1)%4*.05),a?50:800}],[51,11,100,80,.35,800,(t,e,l)=>{let a=l%4;return a?t(0,.3):e(0,8,0,.3),a?250:1e3},150]],[[89,218,60,40,.4,600,(t,e,l)=>{if(t(0,.3,1,Math.PI/24),3>l)return 200}],[89,50,100,120,.4,800,(t,e,l)=>{let a=l%10;return 4>a?t(2,.4):e(0,5,a*Math.PI/12,.3),3>a?200:3==a?500:9>a?100:800},150],[1492,43,40,40,.55,0,0,0,0,.002,1],[320,397,120,200,.15,1400,(t,e,l)=>{if(e(0,12,l%2?0:Math.PI/12,.3+.1*l),4>l)return 100}]],[],[]];function Qt(t){Ht("Please wait\u2026"),xt=1,$=[],bt=[],vt=[],It=[],ht=t,ft=ht-5?t:0}let Xt=0,Kt=0,Zt=0;function _t(t){let e=[...c.children],l=e.indexOf(document.activeElement);do{l+=t,e[l]||(l=t>0?0:e.length-1)}while(e[l].hasAttribute("d"));e[l].focus()}function te(t,e){let l=Math.round(t[0]-t[2]/2),a=Math.round(t[1]-t[3]/2),o=Math.round(e[0]-e[2]/2),n=Math.round(e[1]-e[3]/2);if(l<o+e[2]&&l+t[2]>o&&a<n+e[3]&&a+t[3]>n){let i=Math.min(l+t[2],o+e[2]),r=Math.min(a+t[3],n+e[3]),[h,f,u]=l>o?[0,l-o,i-l]:[o-l,0,i-o],[s,d,M]=a>n?[0,a-n,r-a]:[n-a,0,r-n];for(let l=0;M>l;l++)for(let a=0;u>a;a++)if(t[4][4*((s+l)*t[2]+h+a)+3]>0&&e[4][4*((d+l)*e[2]+f+a)+3]>0)return 1}}function ee(t,e){mt?(mt--,P([119,.44,.85,-340,.1,.08,,.7,5.3,0,0,,.01,.09,.9,-4.2])):Ie(t,e)}function le(t,e){return(l,a)=>{if(t>l)return 1;e(l,a)}}function ae(t,e,l,a,o,n){let i=l[a];return l=>{let r=[t+=.625*(a-1)*(l-n)/4,e-=.625*(l-n),i[0].width,i[0].height,i[1]];for(let t=0;t<de.length;t++)if(de[t](r,o,l))return;if(e+i[0].height/2>0)return n=l,L(i[0],t-i[0].width/2,e-i[0].height/2),1}}function oe([t,e,l,a,o,n,i,r],h,f,u,s){return d=>{let M=(d-s)/u;if(1>M)return A(()=>{z.globalAlpha=1-M**2,z.translate(h+t+n*M,f+e+i*M),z.rotate(r*M),L(o,l,a)}),1}}let ne=["#710","#a21","#d42","#e93","#fa5"];function ie(t,e,l,a,o){let n=r(Math.random(),10,50),i=ne[h(Math.random(),0,ne.length-1)],f=t+h(Math.random(),-l/2,l/2),u=e+h(Math.random(),-a/2,a/2);return t=>{let e=(t-o)/500;if(1>e)return A(()=>{z.globalCompositeOperation="lighter",z.fillStyle=i,z.beginPath(),z.arc(f,u,n*(1-e),0,7),z.fill()}),1}}function re(t,e){return Math.atan2(nt-t,it-e)}function he(t,e,l,a,o,n){let[i,r]=X[t],h=i[0].width,f=i[0].height,u=o*Math.cos(a),s=o*Math.sin(a);return(t,a,o)=>{if(pt>t)return;let d=t-n;return te(ut,[e+=d*s,l+=d*u,h,f,r])&&(ee(t,o),!st)||l-f/2>700||0>l+f/2||e-h/2>480||0>e+h/2?void 0:(n=t,L(i[t%i.length|0],e-h/2,l-f/2),2)}}function fe(t,e,l,a,o,n,i,r){for(let h=0;l>h;h++)t.push(he(e,a,o,n+2*h*Math.PI/l,i,r))}function ue(t,e,l,a,o,n){let i=400-o+n,r=t-l.width/2+(i>0?h(Math.random(),-1,1):0),f=e-l.height/2+(i>0?h(Math.random(),-1,1):0);L(l,r,f),i>0&&A(()=>{z.globalAlpha=i/400,L(a,r,f)})}let se,de,Me,ce,pe,me,ge,Se,ye=[800,2e3,2e3,3e3,4e3];function Ce(t){let a,o,n=4==ht?Ct:ht,i=4==ht?n:0,r=bt[i],h=y(r).data,f=vt[i],u=It[i],s=r.width,d=r.height,M=0,c=1e9,p=1e9,m=t,g=240,S=-800,C=1,w=n-3?0:2,x=0,b=0,I=0,T=(t,e,o)=>{if(te(t,a))return 4==n&&c>=p/2&&p/2>c-e&&(I=1),x=o,c-=e,l.style.width=100*c/p+"%",c>0&&R(),1};return e.style.opacity=1,l.style.width=100*c/p+"%",(t,i,R)=>{let L=0;if(c>0)if(I)I=0,u.map(e=>R.push(oe(v(e,s,d),g-s/2,S-d/2,500,t))),n++,r=bt[n],h=y(r).data,f=vt[n],u=It[n],s=r.width,d=r.height,o=t+1e3,b=0;else{let e=t-m;if(M)if(n>4){if(!st){let t=re(g,S);g+=.1*Math.sin(t)*e,S+=.1*Math.cos(t)*e}}else n&&(1==C?(g+=.1*e,g+s/2>480&&(g=480-s/2,C=2,2==n&&(C=0,w=2))):2==C&&(g-=.1*e,0>g-s/2&&(g=s/2,C=1,2==n&&(C=0,w=1))),2==w?(S+=.1*e,S+d/2>700&&(S=700-d/2,w=1,2==n&&(w=0,C=2))):1==w&&(S-=.1*e,0>S-d/2&&(S=d/2,w=2,2==n&&(w=0,C=1))));else S+=.2*e,S>150&&(S=150,p=c=ye[n],M=1,o=t)}else L=1;if(!L){var A;if(a=[g,S,s,d,h],te(ut,a)&&Ie(t,R),m=t,ue(g,S,r,f,t,x),!st&&1==M&&t>o)if(G(),0==n){if(5>b){let e=S+125;i.push(he(0,g,e,re(g,e),.3,t))}else fe(i,1,16,g,S,b-5?0:Math.PI/16,.5,t);b++,b>6?(b=0,o=t+800):o=b>4?t+100:t+200}else if(1==n){if(8>b){let[e,l]=[[61,75],[78,66],[99,76],[115,65]][Math.floor(b/2)];i.push(he(1,g-e,S+l,0,.6,t),he(1,g+e,S+l,0,.6,t))}else{let e=S+77;i.push(he(3,g,e,re(g,e),.35+.1*(b-8),t))}b++,b>16?(b=0,o=t+800):o=b>8?t+100:8==b?t+500:b%2?t+100:t+200}else if(2==n){if(8>b){let e=re(g,S),l=g+70*Math.sin(e),a=S+70*Math.cos(e);i.push(he(2,l,a,e,.4,t))}else fe(i,1,3,g,S,b*Math.PI/10,.35,t);b++,b>30?(b=0,o=t+800):o=9>b?t+300:t+50}else if(3==n){if(20>b)fe(i,2,2,g,S,Math.PI/20+b*Math.PI/10,.35,t),fe(i,2,2,g,S,-Math.PI/20-b*Math.PI/10,.35,t);else{let e=re(g,S),l=g+70*Math.sin(e),a=S+70*Math.cos(e);i.push(he(1,l,a,e-Math.PI/8,.5,t)),i.push(he(1,l,a,e+Math.PI/8,.5,t)),i.push(he(3,l,a,e,.5,t))}b++,20==b?o=t+1500:b>25?(b=0,o=t+1500):o=b>20?t+150:t+60}else if(4==n){if(12>b){let[e,l]=[[48,113],[79,107],[99,108],[123,102],[156,86],[166,59]][b>5?11-b:b];i.push(he(2,g-e,S+l,0,.6,t),he(2,g+e,S+l,0,.6,t))}else{let e=g+(b%2?21:-21),l=S+112,a=re(e,l);i.push(he(3,e,l,a,.4,t)),i.push(he(2,e,l,a-Math.PI/8,.4,t)),i.push(he(2,e,l,a+Math.PI/8,.4,t)),i.push(he(1,e,l,a-Math.PI/4,.4,t)),i.push(he(1,e,l,a+Math.PI/4,.4,t))}b++,b>16?(b=0,o=t+800):o=b>12?t+150:t+100}else fe(i,3,8,g,S,b%2?0:Math.PI/8,.4,t),b++,b>1?(b=0,o=t+800):o=t+200;return T}e.style.opacity="",l.style.width="",P([369,1,.77,-1.3,.8,,,.7,.4,2,.1,,.37,.05,1.1]),qt(1e3*(n+1)),u.map(e=>i.push(oe(v(e,s,d),g-s/2,S-d/2,500,t)));for(let e=0;Math.ceil(s*d/500)>e;e++)i.push(ie(g,S,s,d,t));ht-4||4==Ct?(A=t,st||(dt=1,K.l=Math.max(ht+1,K.l),jt(),Mt=A+3500,pt=A+1e3,ve("Well Done"))):(Ct++,i.push(le(t+3e3,(t,e)=>e.push(Ce(t)))))}}function we(){return(navigator.getGamepads?[...navigator.getGamepads()]:[]).filter(t=>!!t)}function xe(t){let e=we();for(let l=0;l<e.length;l++)try{if(e[l].buttons[t].pressed)return 1}catch(t){}}function be(t){let e=we(),l=0;for(let a=0;a<e.length;a++)try{l+=e[a].axes[t]}catch(t){}return Math.round(100*l)/100}function ve(e){t.style.transition="",t.style.opacity=0,t.offsetHeight,t.textContent=e,t.style.transition="all 3s ease",t.style.opacity=1}function Ie(t,e){st||dt||(st=1,T(1),Mt=t+3500,H.map(l=>{e.push(oe(v(l,Pt,Rt),nt-Tt,it-Gt,1500,t))}),ve("Signal Lost"))}function Pe(t){let e=g.getBoundingClientRect();return[Math.floor(480*(t.pageX-e.left)/e.width),Math.floor(700*(t.pageY-e.top)/e.height)]}self.onmousedown=t=>{t.preventDefault(),rt=1},self.onmouseup=t=>{t.preventDefault(),rt=0},self.ontouchcancel=self.ontouchend=self.ontouchmove=self.ontouchstart=t=>{let e=t.touches;if(t.preventDefault(),et=e.length>1,null!=lt)for(let t=0;t<e.length;t++)if(e[t].identifier==lt){let[l,a]=Pe(e[t]);return at+=l-_,ot+=a-tt,_=l,void(tt=a)}if(e.length>0)return lt=e[0].identifier,void([_,tt]=Pe(e[0]));lt=null},self.onmousemove=t=>{t.preventDefault(),[at,ot]=Pe(t)},self.onkeydown=self.onkeyup=t=>{t.preventDefault(),At[t.keyCode]=t.type[5]},q.width=480,q.height=700,function a(o){xt>1?(a=>{let o=a-Se;Se=a,o>200&&(kt+=o-40,o=40,At=[],rt=et=0);let n=a-kt;if(3==xt&&!st&&!dt){let t=.6*o,e=be(0),l=be(1);if((At[38]||At[87]||At[90]||xe(12))&&l--,(At[40]||At[83]||xe(13))&&l++,(At[37]||At[65]||At[81]||xe(14))&&e--,(At[39]||At[68]||xe(15))&&e++,At[13]||At[32]||xe(0)||xe(1)||xe(2)||xe(3)||xe(9)||rt||et?St||(r=n,gt&&r>pt&&(gt--,zt(),T(1.5),pt=r+1e3,pe+=1500,me+=1500),St=1):St=0,e||l){let a=Math.max(Math.hypot(e,l),1);nt+=t*e/a,it+=t*l/a,at=nt,ot=it}else{let e=at-nt,l=ot-it,a=Math.hypot(e,l);a>t?(nt+=e/a*t,it+=l/a*t):(nt=at,it=ot)}Tt>nt?nt=Tt:nt>480-Tt&&(nt=480-Tt),Gt>it?it=Gt:it>700-Gt&&(it=700-Gt),ut=[nt,it,Pt,Rt,Lt]}var r;dt&&n+2500>Mt&&(it+=.6*o*(Mt-3e3-n)/2e3),2==xt&&(ot=it=700+Gt-Math.min(1,2*n/2500)*(Rt+20)),z.fillStyle="#002",z.fillRect(0,0,1e9,1e9);for(let t,e=100;e--;z.fillStyle=W[e%W.length],S(z,-60*(1-e/100)*nt/(480-Pt)+102797*(1+Math.sin(t))*e%540,700*(Math.tan(e/9)+t*n/3e3)%700,3.3*(t-.3)))t=150/(3*e+200);let f=[],u=[],s=[];if(se.map(function t(e){let l=[],a=e(n,l,u);a&&(2==a?u.push(e):f.push(e),a.call&&s.push(a)),l.map(t)}),se=f.concat(u),de=s,!st){if(mt){let t=j[Math.max(0,j.length-mt)];L(t,nt-Math.floor(t.width/2),it-Math.floor(t.height/2))}let t=Y[h(Math.random(),0,1)][0];L(t,nt-t.width/2,it+Gt-1),L(N,nt-Tt,it-Gt)}if(pt>n&&A(()=>{z.globalAlpha=(pt-n)/1e3,z.fillRect(0,0,1e9,1e9)}),3==xt&&!st&&!dt&&n>Me+200){let[t,e]=K.u[1]>2?[Q,20]:[F,10];(K.u[1]&&!yt||K.u[1]>1&&1==yt||K.u[1]>3)&&(se.push(ae(nt-25,it-Math.floor(Rt/2),t,0,e,n)),se.push(ae(nt+25,it-Math.floor(Rt/2),t,2,e,n)));let[l,a]=K.u[0]>2?[Q,20]:[F,10];K.u[0]&&(se.push(ae(nt-13,it-Math.floor(Rt/2)+7,l,1,a,n)),se.push(ae(nt+13,it-Math.floor(Rt/2)+7,l,1,a,n))),K.u[0]%2==0&&se.push(ae(nt,it-Math.floor(Rt/2)-8,l,1,a,n)),Me=n,P([292,.08,.74,,,,.43,,-3.9,3,.01,.02]),yt=(yt+1)%4}if(n>me&&!ge&&(++Ct%6?me=n+1e4:ht-5&&(ge=1,se.push(Ce(n)))),!ge&&n>pe){let t=h(ce(),0,Math.min(Ct,$.length-1)),e=h(ce(),30,450),l=50*(t+1),a=(a,o)=>o.push((([t,e,l,a,o,n,i,r,f,u,s,d],M,c,p)=>{let g,S=t.width,C=t.height,w=-C/2,x=0,b=p,I=i&&p+i,k=0,D=st?0:re(M,w),O=(t,e,l)=>{if(te(t,g))return x=l,(o-=e)>0&&R(),1};return(i,d,p)=>{let R=i-b,U=0;if(0>=o||pt>i)U=1;else{if(s){if(!st&&it>w){let t=re(M,w)-D,e=Math.atan2(Math.sin(t),Math.cos(t)),l=s*R;D+=0>e?Math.max(e,-l):Math.min(e,l)}M+=R*n*Math.sin(D),w+=R*n*Math.cos(D)}else w+=R*n;!st&&f&&(w=Math.min(w,f)),g=[M,w,S,C,e],te(ut,g)&&(ee(i,p),st||(U=1))}if(U){T(S/275),u&&fe(d,u[0],u[1],M,w+17*n,2*Math.PI/u[2],u[2],i);let t=a.map(()=>0),e=(u?2:1)*(ht-5?h(Math.random(),1,ht+1):0);for(let l=0;e>l;l++)t[h(Math.random(),0,a.length/2)]=1;a.map((e,l)=>d.push(t[l]?(([t,e,l,a,o,n,i],r,h,f)=>{let u=r+t+l,s=h+e+a,d=f,M=Math.atan2(i,n),c=y(o).data,p=.2+.1*K.u[4],[g,S]=m(o.width,o.height);return S.drawImage(o,0,0),S.fillStyle="#fff",S.globalCompositeOperation="source-in",S.fillRect(0,0,g.width,g.height),t=>{let e=(t-d)/500,l=t-f,a=Math.hypot(nt-u,it-s);if(!st&&a<60*K.u[4]){let t=re(u,s);u+=Math.sin(t)*p*l,s+=Math.cos(t)*p*l}else 1>e&&(u+=3*(1-e)*Math.cos(M),s+=3*(1-e)*Math.sin(M),(0>u||u>480-o.width)&&(M+=Math.PI)),s+=.1*l;return!st&&te(ut,[u,s,o.width,o.height,c])?(Wt(1),void P([1675,.24,1,,,0,,,,1,,,,1.82,,,,.06,837])):s>700?void 0:(f=t,L(o,u-o.width/2,s-o.height/2),A(()=>{z.globalAlpha=.5+Math.sin(t/100)/2,L(g,u-o.width/2,s-o.height/2)}),1)}})(v(e,S,C),M-S/2,w-C/2,i):oe(v(e,S,C),M-S/2,w-C/2,500,i)));for(let t=0;Math.ceil(S*C/500)>t;t++)d.push(ie(M,w,S,C,i));return qt(c)}if(700>=w-C/2){if(ue(M,w,t,l,i,x),!st&&I&&i>I){let t=w+17*n;G();let e=r((e,l,a,o)=>{let n=re(M,t);if(d.push(he(e,M,t,n,l,i)),a)for(let r=0;a>r;r++)d.push(he(e,M,t,n+(r+1)*o,l,i),he(e,M,t,n-(r+1)*o,l,i))},(e,l,a,o)=>{fe(d,e,l,M,t,a,o,i)},++k);I=e&&I+e}return b=i,O}}})($[t],e,l,a));if($[t][11])for(let t=0;3>t;t++)se.push(le(n+300*(t+1),a));a(n,se),pe+=Math.max(0,1e3-50*Ct)+Math.round(400*ce())}Mt&&n>Mt&&(l.style.width=e.style.opacity=i.textContent=p.textContent=b.textContent="",e.style.transition="initial",e.offsetHeight,e.style.transition="",(()=>{let t=[];t.push("You got "+wt.toLocaleString()+" points"),ct&&t.push("New Top Score!"),dt?t.push(["Next, "+V[ht+1],()=>Qt(ht+1)]):t.push(["Try Again",()=>Qt(ht)]),t.push(["Upgrades",()=>Ht("Upgrades",Ut())]),wt&&t.push(["Tweet Score",()=>open("//twitter.com/intent/tweet?hashtags=js13k&url="+location+"&text="+encodeURIComponent("I got "+wt.toLocaleString()+" points in Galaxy Raid's "+V[ht]+" mission!"))]),t.push(Dt),Ht(ht-5?dt?ht-4?"Victory":"Total Victory!!":"Defeat":"Good Try",t)})(),xt=0),2==xt&&n>2500&&(xt=3,t.style.opacity=0,t.style.transition="all .5s ease",4==ht&&se.push(Ce(n)))})(o):(t=>{z.fillStyle="#002",z.fillRect(0,0,1e9,1e9);for(let e=100;e--;){z.fillStyle=W[e%W.length];let l=100/(4-(t/1e3+e/13)%4);S(z,Math.cos(e)*l+240,Math.sin(e*e)*l+350,l/100)}let e=be(1);At[38]||At[87]||At[90]||xe(12)||-.8>e?Kt||(_t(-1),Kt=1):Kt=0,At[40]||At[83]||xe(13)||e>.8?Xt||(_t(1),Xt=1):Xt=0,At[13]||At[32]||xe(0)||xe(1)||xe(2)||xe(3)||xe(9)?Zt||(document.activeElement.onpointerdown(),Zt=1):Zt=0,xt&&(ht-5&&(!bt.length||4==ht&&bt.length-Jt.length)?(()=>{let t=[...Jt[4==ht?bt.length:ht]],e=E(C(w(Vt[ht],...t)));bt.push(e),vt.push(k(e)),It.push(x(e))})():ft==ht||5==ht&&ft<Ft.length?$.push(...Ft[ft++].map(t=>(([t,e,l,...a])=>{let o=C(E(w(Vt[ht],t,e,l)));return[o,y(o).data,k(o),x(o),...a]})(t))):(ve("Good Luck"),xt=2,ce=d(Yt[ht]),pe=3500,me=7500,se=[],de=[],Se=kt=performance.now(),gt=K.u[3],ge=4==ht,qt(st=dt=Ct=Me=pt=wt=Mt=yt=ct=0),zt(),at=nt=240,it=700+Gt,mt=K.u[2]))})(o),requestAnimationFrame(a)}(kt);</script>